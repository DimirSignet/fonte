{"sha": "686146c4de7d2bd985156ae15175365633dd0f94", "log": "Handle 'this' properly in the RAI. fixes issue 769  R=johnlenz DELTA=11  (11 added, 0 deleted, 0 changed)   Revision created by MOE tool push_codebase. MOE_MIGRATION=5099   ", "commit": "\n--- a/src/com/google/javascript/jscomp/type/ChainableReverseAbstractInterpreter.java\n+++ b/src/com/google/javascript/jscomp/type/ChainableReverseAbstractInterpreter.java\n         JSType origType = node.getJSType();\n         origType = origType == null ? getNativeType(UNKNOWN_TYPE) : origType;\n         scope.inferQualifiedSlot(node, qualifiedName, origType, type);\n+        break;\n+\n+      case Token.THIS:\n+        // \"this\" references aren't currently modeled in the CFG.\n         break;\n \n       default:\n--- a/test/com/google/javascript/jscomp/TypeInferenceTest.java\n+++ b/test/com/google/javascript/jscomp/TypeInferenceTest.java\n \n     assertEquals(\"{foo: (number|undefined)}\", getType(\"y\").toString());\n   }\n+\n+  public void testNoThisInference() {\n+    JSType thisType = createNullableType(OBJECT_TYPE);\n+    assumingThisType(thisType);\n+    inFunction(\"var out = 3; if (goog.isNull(this)) out = this;\");\n+    verify(\"out\", createUnionType(OBJECT_TYPE, NUMBER_TYPE));\n+  }\n }", "timestamp": 1341288794, "metainfo": ""}