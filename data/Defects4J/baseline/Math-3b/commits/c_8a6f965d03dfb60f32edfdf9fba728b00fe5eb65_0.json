{"sha": "8a6f965d03dfb60f32edfdf9fba728b00fe5eb65", "log": "Fixed inverse cumulative probability for uniform distribution.  JIRA: MATH-957  ", "commit": "\n--- a/src/main/java/org/apache/commons/math3/distribution/UniformRealDistribution.java\n+++ b/src/main/java/org/apache/commons/math3/distribution/UniformRealDistribution.java\n package org.apache.commons.math3.distribution;\n \n import org.apache.commons.math3.exception.NumberIsTooLargeException;\n+import org.apache.commons.math3.exception.OutOfRangeException;\n import org.apache.commons.math3.exception.util.LocalizedFormats;\n import org.apache.commons.math3.random.RandomGenerator;\n import org.apache.commons.math3.random.Well19937c;\n  * @since 3.0\n  */\n public class UniformRealDistribution extends AbstractRealDistribution {\n-    /** Default inverse cumulative probability accuracy. */\n+    /** Default inverse cumulative probability accuracy.\n+     * @deprecated as of 3.2 not used anymore, will be removed in 4.0\n+     */\n+    @Deprecated\n     public static final double DEFAULT_INVERSE_ABSOLUTE_ACCURACY = 1e-9;\n     /** Serializable version identifier. */\n     private static final long serialVersionUID = 20120109L;\n     private final double lower;\n     /** Upper bound of this distribution (exclusive). */\n     private final double upper;\n-    /** Inverse cumulative probability accuracy. */\n-    private final double solverAbsoluteAccuracy;\n \n     /**\n      * Create a standard uniform real distribution with lower bound (inclusive)\n      */\n     public UniformRealDistribution(double lower, double upper)\n         throws NumberIsTooLargeException {\n-        this(lower, upper, DEFAULT_INVERSE_ABSOLUTE_ACCURACY);\n+        this(new  Well19937c(), lower, upper);\n     }\n \n     /**\n      * @param upper Upper bound of this distribution (exclusive).\n      * @param inverseCumAccuracy Inverse cumulative probability accuracy.\n      * @throws NumberIsTooLargeException if {@code lower >= upper}.\n-     */\n+     * @deprecated as of 3.2, inverse CDF is now calculated analytically, use\n+     *             {@link #UniformRealDistribution(double, double)} instead.\n+     */\n+    @Deprecated\n     public UniformRealDistribution(double lower, double upper, double inverseCumAccuracy)\n         throws NumberIsTooLargeException {\n-        this(new  Well19937c(), lower, upper, inverseCumAccuracy);\n+        this(new  Well19937c(), lower, upper);\n     }\n \n     /**\n      * @param inverseCumAccuracy Inverse cumulative probability accuracy.\n      * @throws NumberIsTooLargeException if {@code lower >= upper}.\n      * @since 3.1\n-     */\n+     * @deprecated as of 3.2, inverse CDF is now calculated analytically, use\n+     *             {@link #UniformRealDistribution(RandomGenerator, double, double)}\n+     *             instead.\n+     */\n+    @Deprecated\n     public UniformRealDistribution(RandomGenerator rng,\n                                    double lower,\n                                    double upper,\n-                                   double inverseCumAccuracy)\n+                                   double inverseCumAccuracy){\n+        this(rng, lower, upper);\n+    }\n+\n+    /**\n+     * Creates a uniform distribution.\n+     *\n+     * @param rng Random number generator.\n+     * @param lower Lower bound of this distribution (inclusive).\n+     * @param upper Upper bound of this distribution (exclusive).\n+     * @throws NumberIsTooLargeException if {@code lower >= upper}.\n+     * @since 3.1\n+     */\n+    public UniformRealDistribution(RandomGenerator rng,\n+                                   double lower,\n+                                   double upper)\n         throws NumberIsTooLargeException {\n         super(rng);\n         if (lower >= upper) {\n \n         this.lower = lower;\n         this.upper = upper;\n-        solverAbsoluteAccuracy = inverseCumAccuracy;\n     }\n \n     /** {@inheritDoc} */\n         return (x - lower) / (upper - lower);\n     }\n \n-    /** {@inheritDoc} */\n     @Override\n-    protected double getSolverAbsoluteAccuracy() {\n-        return solverAbsoluteAccuracy;\n+    public double inverseCumulativeProbability(final double p)\n+            throws OutOfRangeException {\n+        if (p < 0.0 || p > 1.0) {\n+            throw new OutOfRangeException(p, 0, 1);\n+        }\n+        return p * (upper - lower) + lower;\n     }\n \n     /**\n--- a/src/test/java/org/apache/commons/math3/distribution/UniformRealDistributionTest.java\n+++ b/src/test/java/org/apache/commons/math3/distribution/UniformRealDistributionTest.java\n         Assert.assertEquals(dist.getNumericalMean(), 0.375, 0);\n         Assert.assertEquals(dist.getNumericalVariance(), 0.2552083333333333, 0);\n     }\n+    \n+    /** \n+     * Check accuracy of analytical inverse CDF. Fails if a solver is used \n+     * with the default accuracy. \n+     */\n+    @Test\n+    public void testInverseCumulativeDistribution() {\n+        UniformRealDistribution dist = new UniformRealDistribution(0, 1e-9);\n+        \n+        Assert.assertEquals(2.5e-10, dist.inverseCumulativeProbability(0.25), 0);\n+    }\n }", "timestamp": 1364466030, "metainfo": ""}