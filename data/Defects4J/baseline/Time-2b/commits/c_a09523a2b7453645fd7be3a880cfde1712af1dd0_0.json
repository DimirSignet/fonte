{"sha": "a09523a2b7453645fd7be3a880cfde1712af1dd0", "log": "Performance enhancement of critical method, when running in server JVM.   ", "commit": "\n--- a/JodaTime/src/java/org/joda/time/chrono/BaseGJChronology.java\n+++ b/JodaTime/src/java/org/joda/time/chrono/BaseGJChronology.java\n         cHalfdayOfDayField = new HalfdayField();\n     }\n \n-    private transient YearInfo[] iYearInfoCache;\n-    private transient int iYearInfoCacheMask;\n+    private static final int CACHE_SIZE = 1;\n+    private static final int CACHE_MASK = CACHE_SIZE - 1;\n+\n+    private final YearInfo[] iYearInfoCache = new YearInfo[CACHE_SIZE];\n \n     private final int iMinDaysInFirstWeek;\n \n         }\n \n         iMinDaysInFirstWeek = minDaysInFirstWeek;\n-\n-        Integer i;\n-        try {\n-            i = Integer.getInteger(getClass().getName().concat(\".yearInfoCacheSize\"));\n-        } catch (SecurityException e) {\n-            i = null;\n-        }\n-\n-        int cacheSize;\n-        if (i == null) {\n-            cacheSize = 1024; // (1 << 10)\n-        } else {\n-            cacheSize = i.intValue();\n-            // Ensure cache size is even power of 2.\n-            cacheSize--;\n-            int shift = 0;\n-            while (cacheSize > 0) {\n-                shift++;\n-                cacheSize >>= 1;\n-            }\n-            cacheSize = 1 << shift;\n-        }\n-\n-        iYearInfoCache = new YearInfo[cacheSize];\n-        iYearInfoCacheMask = cacheSize - 1;\n     }\n \n     public DateTimeZone getZone() {\n     //-----------------------------------------------------------------------\n     // Although accessed by multiple threads, this method doesn't need to be synchronized.\n     private YearInfo getYearInfo(int year) {\n-        YearInfo[] cache = iYearInfoCache;\n-        int index = year & iYearInfoCacheMask;\n-        YearInfo info = cache[index];\n+        YearInfo info = iYearInfoCache[year & CACHE_MASK];\n         if (info == null || info.iYear != year) {\n             info = new YearInfo(year, calculateFirstDayOfYearMillis(year));\n-            cache[index] = info;\n+            iYearInfoCache[year & CACHE_MASK] = info;\n         }\n         return info;\n     }", "timestamp": 1129017107, "metainfo": ""}