{"sha": "c59fc43c527610ae18d7596eb191817ce674cb29", "log": "COMPRESS-379 fix symlink logic", "commit": "\n--- a/src/main/java/org/apache/commons/compress/archivers/zip/UnixStat.java\n+++ b/src/main/java/org/apache/commons/compress/archivers/zip/UnixStat.java\n      * Bits used for permissions (and sticky bit)\n      */\n     int PERM_MASK = 07777;\n+    /**\n+     * Bits used to indicate the filesystem object type.\n+     * @since 1.14\n+     */\n+    int FILE_TYPE_FLAG = 0170000;\n     /**\n      * Indicates symbolic links.\n      */\n--- a/src/main/java/org/apache/commons/compress/archivers/zip/ZipArchiveEntry.java\n+++ b/src/main/java/org/apache/commons/compress/archivers/zip/ZipArchiveEntry.java\n      * @return true if the entry represents a unix symlink, false otherwise.\n      */\n     public boolean isUnixSymlink() {\n-        return (getUnixMode() & UnixStat.LINK_FLAG) == UnixStat.LINK_FLAG;\n+        return (getUnixMode() & UnixStat.FILE_TYPE_FLAG) == UnixStat.LINK_FLAG;\n     }\n \n     /**\n--- a/src/test/java/org/apache/commons/compress/archivers/zip/ZipArchiveEntryTest.java\n+++ b/src/test/java/org/apache/commons/compress/archivers/zip/ZipArchiveEntryTest.java\n \n package org.apache.commons.compress.archivers.zip;\n \n+import static org.apache.commons.compress.AbstractTestCase.getFile;\n import static org.junit.Assert.*;\n \n import java.io.ByteArrayOutputStream;\n         final ZipArchiveEntry copy = new ZipArchiveEntry(archiveEntry);\n         assertEquals(archiveEntry, copy);\n     }\n+\n+    /**\n+     * @see \"https://issues.apache.org/jira/browse/COMPRESS-379\"\n+     */\n+    @Test\n+    public void isUnixSymlinkIsFalseIfMoreThanOneFlagIsSet() throws Exception {\n+        try (ZipFile zf = new ZipFile(getFile(\"COMPRESS-379.jar\"))) {\n+            ZipArchiveEntry ze = zf.getEntry(\"META-INF/maven/\");\n+            assertFalse(ze.isUnixSymlink());\n+        }\n+    }\n }", "timestamp": 1484514439, "metainfo": ""}