{"sha": "e79465bbecc6033780f91fd41ab7d66c5e9e7bae", "log": "tweaks", "commit": "\n--- a/src/main/java/org/apache/commons/compress/compressors/lz4/FramedLZ4CompressorInputStream.java\n+++ b/src/main/java/org/apache/commons/compress/compressors/lz4/FramedLZ4CompressorInputStream.java\n                 r = readOnce(b, off, len);\n             }\n         }\n-        if (expectBlockDependency) {\n-            appendToBlockDependencyBuffer(b, off, r);\n-        }\n-        if (expectContentChecksum && r != -1) {\n-            contentHash.update(b, off, r);\n+        if (r != -1) {\n+            if (expectBlockDependency) {\n+                appendToBlockDependencyBuffer(b, off, r);\n+            }\n+            if (expectContentChecksum) {\n+                contentHash.update(b, off, r);\n+            }\n         }\n         return r;\n     }\n         int read = IOUtils.readFully(in, b);\n         count(read);\n         if (0 == read && !firstFrame) {\n+            // good LZ4 frame and nothing after it\n             endReached = true;\n             return false;\n         }\n \n         read = skipSkippableFrame(b);\n         if (0 == read && !firstFrame) {\n+            // good LZ4 frame with only some skippable frames after it\n             endReached = true;\n             return false;\n         }", "timestamp": 1486658237, "metainfo": ""}