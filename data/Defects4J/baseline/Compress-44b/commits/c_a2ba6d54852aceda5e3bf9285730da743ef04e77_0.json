{"sha": "a2ba6d54852aceda5e3bf9285730da743ef04e77", "log": "Bugfix for COMPRESS-343", "commit": "\n--- a/src/main/java/org/apache/commons/compress/archivers/sevenz/Coders.java\n+++ b/src/main/java/org/apache/commons/compress/archivers/sevenz/Coders.java\n         InputStream decode(final String archiveName, final InputStream in, long uncompressedLength,\n                 final Coder coder, final byte[] password)\n             throws IOException {\n-            return new InflaterInputStream(new DummyByteAddingInputStream(in),\n-                                           new Inflater(true));\n+            final Inflater inflater = new Inflater(true);\n+            final InflaterInputStream inflaterInputStream = new InflaterInputStream(new DummyByteAddingInputStream(in),\n+                    inflater);\n+            return new InputStream() {\n+                @Override\n+                public int read() throws IOException {\n+                    return inflaterInputStream.read();\n+                }\n+\n+                @Override\n+                public int read(byte[] b, int off, int len) throws IOException {\n+                    return inflaterInputStream.read(b, off, len);\n+                }\n+\n+                @Override\n+                public int read(byte[] b) throws IOException {\n+                    return inflaterInputStream.read(b);\n+                }\n+\n+                @Override\n+                public void close() throws IOException {\n+                    inflaterInputStream.close();\n+                    inflater.end();\n+                }\n+            };\n         }\n         @Override\n         OutputStream encode(final OutputStream out, final Object options) {\n             int level = numberOptionOrDefault(options, 9);\n-            return new DeflaterOutputStream(out, new Deflater(level, true));\n+            final Deflater deflater = new Deflater(level, true);\n+            final DeflaterOutputStream deflaterOutputStream = new DeflaterOutputStream(out, deflater);\n+            return new OutputStream() {\n+                @Override\n+                public void write(int b) throws IOException {\n+                    deflaterOutputStream.write(b);\n+                }\n+\n+                @Override\n+                public void write(byte[] b) throws IOException {\n+                    deflaterOutputStream.write(b);\n+                }\n+\n+                @Override\n+                public void write(byte[] b, int off, int len) throws IOException {\n+                    deflaterOutputStream.write(b, off, len);\n+                }\n+\n+                @Override\n+                public void close() throws IOException {\n+                    deflaterOutputStream.close();\n+                    deflater.end();\n+                }\n+            };\n         }\n     }\n ", "timestamp": 1458206849, "metainfo": ""}