{"sha": "60d6b6ac126ce3b4b1c83e537f26f564900e2eda", "log": "COMPRESS-117 Certain tar files not recognised by ArchiveStreamFactory Check if first entry can be read as a Tar entry  ", "commit": "\n--- a/src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java\n+++ b/src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java\n  */\n package org.apache.commons.compress.archivers;\n \n+import java.io.ByteArrayInputStream;\n import java.io.IOException;\n import java.io.InputStream;\n import java.io.OutputStream;\n             if (TarArchiveInputStream.matches(tarheader, signatureLength)) {\n                 return new TarArchiveInputStream(in);\n             }\n+            // COMPRESS-117 - improve auto-recognition\n+            try {\n+                TarArchiveInputStream tais = new TarArchiveInputStream(new ByteArrayInputStream(tarheader));\n+                tais.getNextEntry();\n+                return new TarArchiveInputStream(in);\n+            } catch (Exception e) { // can generate IllegalArgumentException as well as IOException\n+                // ignored\n+            }\n         } catch (IOException e) {\n             throw new ArchiveException(\"Could not use reset and mark operations.\", e);\n         }", "timestamp": 1300884615, "metainfo": ""}