{"sha": "3a1451bddfdd74cfbc6f9c184a51a32696cec2a2", "log": "COMPRESS-267 add a matches method to SevenZFile  ", "commit": "\n--- a/src/main/java/org/apache/commons/compress/archivers/sevenz/SevenZFile.java\n+++ b/src/main/java/org/apache/commons/compress/archivers/sevenz/SevenZFile.java\n         }\n         return value;\n     }\n+\n+    /**\n+     * Checks if the signature matches what is expected for a 7z file.\n+     *\n+     * @param signature\n+     *            the bytes to check\n+     * @param length\n+     *            the number of bytes to check\n+     * @return true, if this is the signature of a 7z archive.\n+     * @since 1.8\n+     */\n+    public static boolean matches(byte[] signature, int length) {\n+        if (length < sevenZSignature.length) {\n+            return false;\n+        }\n+\n+        for (int i = 0; i < sevenZSignature.length; i++) {\n+            if (signature[i] != sevenZSignature[i]) {\n+                return false;\n+            }\n+        }\n+        return true;\n+    }\n }\n--- a/src/test/java/org/apache/commons/compress/archivers/sevenz/SevenZFileTest.java\n+++ b/src/test/java/org/apache/commons/compress/archivers/sevenz/SevenZFileTest.java\n         }\n     }\n \n+    public void testSignatureCheck() {\n+        assertTrue(SevenZFile.matches(SevenZFile.sevenZSignature,\n+                                      SevenZFile.sevenZSignature.length));\n+        assertTrue(SevenZFile.matches(SevenZFile.sevenZSignature,\n+                                      SevenZFile.sevenZSignature.length + 1));\n+        assertFalse(SevenZFile.matches(SevenZFile.sevenZSignature,\n+                                      SevenZFile.sevenZSignature.length - 1));\n+        assertFalse(SevenZFile.matches(new byte[] { 1, 2, 3, 4, 5, 6 }, 6));\n+        assertTrue(SevenZFile.matches(new byte[] { '7', 'z', (byte) 0xBC,\n+                                                   (byte) 0xAF, 0x27, 0x1C}, 6));\n+        assertFalse(SevenZFile.matches(new byte[] { '7', 'z', (byte) 0xBC,\n+                                                    (byte) 0xAF, 0x27, 0x1D}, 6));\n+    }\n+\n     private void test7zUnarchive(File f, byte[] password) throws Exception {\n         SevenZFile sevenZFile = new SevenZFile(f, password);\n         try {", "timestamp": 1393095501, "metainfo": ""}