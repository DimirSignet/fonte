{"sha": "ff615cb9580ce99d48ec5da88be3b37213185076", "log": "the loop searching for the signature could be reading beyond the start of the archive  ", "commit": "\n--- a/src/main/java/org/apache/commons/compress/archivers/zip/ZipFile.java\n+++ b/src/main/java/org/apache/commons/compress/archivers/zip/ZipFile.java\n                                          byte[] sig) throws IOException {\n         boolean found = false;\n         long off = archive.length() - minDistanceFromEnd;\n-        long stopSearching = Math.max(0L, archive.length() - maxDistanceFromEnd);\n+        final long stopSearching =\n+            Math.max(0L, archive.length() - maxDistanceFromEnd);\n         if (off >= 0) {\n-            archive.seek(off);\n-            int curr = archive.read();\n-            while (off >= stopSearching && curr != -1) {\n+            for (; off >= stopSearching; off--) {\n+                archive.seek(off);\n+                int curr = archive.read();\n+                if (curr == -1) {\n+                    break;\n+                }\n                 if (curr == sig[POS_0]) {\n                     curr = archive.read();\n                     if (curr == sig[POS_1]) {\n                         }\n                     }\n                 }\n-                archive.seek(--off);\n-                curr = archive.read();\n             }\n         }\n         if (found) {", "timestamp": 1312426726, "metainfo": ""}