{"sha": "33cd35e5d60f03e191ce74f85523b099a3c1944c", "log": "COMPRESS-110 Support \"ustar\" prefix field Add support for identifying Pax headers  ", "commit": "\n--- a/src/main/java/org/apache/commons/compress/archivers/tar/TarArchiveEntry.java\n+++ b/src/main/java/org/apache/commons/compress/archivers/tar/TarArchiveEntry.java\n     }\n \n     /**\n+     * Check if this is a Pax header.\n+     * \n+     * @return <code>true</code> if this is a Pax header.\n+     */\n+    public boolean isPaxHeader(){\n+        return linkFlag == LF_PAX_EXTENDED_HEADER || linkFlag == LF_PAX_GLOBAL_EXTENDED_HEADER;\n+    }\n+\n+    /**\n      * Return whether or not this entry represents a directory.\n      *\n      * @return True if this entry is a directory.\n         devMajor = (int) TarUtils.parseOctal(header, offset, DEVLEN);\n         offset += DEVLEN;\n         devMinor = (int) TarUtils.parseOctal(header, offset, DEVLEN);\n+        offset += DEVLEN;\n+        String prefix = TarUtils.parseName(header, offset, PREFIXLEN);\n+        if (prefix.length() >0){\n+            name = prefix + \"/\" + name;\n+        }\n     }\n \n     /**\n--- a/src/main/java/org/apache/commons/compress/archivers/tar/TarConstants.java\n+++ b/src/main/java/org/apache/commons/compress/archivers/tar/TarConstants.java\n     byte   LF_CONTIG = (byte) '7';\n \n     /**\n+     * Identifies the *next* file on the tape as having a long name.\n+     */\n+    byte LF_GNUTYPE_LONGNAME = (byte) 'L';\n+\n+    // See \"http://www.opengroup.org/onlinepubs/009695399/utilities/pax.html#tag_04_100_13_02\"\n+\n+    /**\n+     * Identifies the entry as a Pax extended header.\n+     */\n+    byte LF_PAX_EXTENDED_HEADER = (byte) 'x';\n+    \n+    /**\n+     * Identifies the entry as a Pax global extended header.\n+     */\n+    byte LF_PAX_GLOBAL_EXTENDED_HEADER = (byte) 'g';\n+    \n+    /**\n      * The magic tag representing a POSIX tar archive.\n      */\n     String MAGIC_POSIX = \"ustar\\0\";\n     String VERSION_GNU_ZERO  = \"0\\0\";\n \n     /**\n+     * The magic tag representing an Ant tar archive.\n+     */\n+    String MAGIC_ANT = \"ustar\\0\";\n+    // Does not appear to have a version, however Ant does write 8 bytes,\n+    // so assume the version is 2 nulls\n+    String VERSION_ANT = \"\\0\\0\";\n+\n+    /**\n      * The name of the GNU tar entry which contains a long name.\n      */\n     String GNU_LONGLINK = \"././@LongLink\"; // TODO rename as LONGLINK_GNU ?\n \n-    /**\n-     * Identifies the *next* file on the tape as having a long name.\n-     */\n-    byte LF_GNUTYPE_LONGNAME = (byte) 'L';\n }", "timestamp": 1273437500, "metainfo": ""}