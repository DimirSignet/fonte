{"sha": "f1d5df0a6c8ce43fe34e543277335220b79a0ca9", "log": "don't try to keep the whole entry in memory  ", "commit": "\n--- a/src/main/java/org/apache/commons/compress/archivers/sevenz/CLI.java\n+++ b/src/main/java/org/apache/commons/compress/archivers/sevenz/CLI.java\n import java.io.IOException;\n \n public class CLI {\n+\n+    private static final byte[] BUF = new byte[8192];\n \n     private static enum Mode {\n         LIST(\"Analysing\") {\n                 }\n                 FileOutputStream fos = new FileOutputStream(outFile);\n                 try {\n-                    byte[] contents = new byte[(int) entry.getSize()];\n-                    int off = 0;\n-                    while (off < contents.length) {\n-                        int bytesRead = archive.read(contents, off,\n-                                                     contents.length - off);\n-                        System.err.println(\"read at offset \" + off + \" returned \"\n-                                           + bytesRead + \" bytes.\");\n+                    final long total = entry.getSize();\n+                    long off = 0;\n+                    while (off < total) {\n+                        int toRead = (int) Math.min(total - off, BUF.length);\n+                        int bytesRead = archive.read(BUF, 0, toRead);\n                         if (bytesRead < 1) {\n                             throw new IOException(\"reached end of entry \"\n                                                   + entry.getName()\n                                                   + \" after \" + off\n                                                   + \" bytes, expected \"\n-                                                  + contents.length);\n+                                                  + total);\n                         }\n                         off += bytesRead;\n+                        fos.write(BUF, 0, bytesRead);\n                     }\n-                    fos.write(contents);\n                 } finally {\n                     fos.close();\n                 }", "timestamp": 1408207165, "metainfo": ""}