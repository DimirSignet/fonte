{"sha": "0d6defe95b3fc620943343d3a56cec131950c33e", "log": "COMPRESS-208 properly detect split ZIP files  ", "commit": "\n--- a/src/main/java/org/apache/commons/compress/archivers/zip/ZipArchiveInputStream.java\n+++ b/src/main/java/org/apache/commons/compress/archivers/zip/ZipArchiveInputStream.java\n         }\n \n         return checksig(signature, ZipArchiveOutputStream.LFH_SIG) // normal file\n-            || checksig(signature, ZipArchiveOutputStream.EOCD_SIG); // empty zip\n+            || checksig(signature, ZipArchiveOutputStream.EOCD_SIG) // empty zip\n+            || checksig(signature, ZipArchiveOutputStream.DD_SIG) // split zip\n+            || checksig(signature,\n+                        ZipLong.SINGLE_SEGMENT_SPLIT_MARKER.getBytes());\n     }\n \n     private static boolean checksig(byte[] signature, byte[] expected){\n--- a/src/test/java/org/apache/commons/compress/archivers/ArchiveStreamFactoryTest.java\n+++ b/src/test/java/org/apache/commons/compress/archivers/ArchiveStreamFactoryTest.java\n import java.io.FileInputStream;\n import java.io.InputStream;\n \n+import org.apache.commons.compress.archivers.zip.ZipArchiveInputStream;\n import org.junit.Test;\n \n public class ArchiveStreamFactoryTest {\n         }\n     }\n \n+    /**\n+     * Test case for \n+     * <a href=\"https://issues.apache.org/jira/browse/COMPRESS-208\"\n+     * >COMPRESS-208</a>.\n+     */\n+    @Test\n+    public void skipsPK00Prefix() throws Exception {\n+        InputStream is = null;\n+        try {\n+            is = new BufferedInputStream(new FileInputStream(\"src/test/resources/COMPRESS-208.zip\"));\n+            ArchiveInputStream ais = new ArchiveStreamFactory().createArchiveInputStream(is);\n+            assertTrue(ais instanceof ZipArchiveInputStream);\n+        } finally {\n+            if (is != null) {\n+                is.close();\n+            }\n+        }\n+    }\n }", "timestamp": 1357038348, "metainfo": ""}