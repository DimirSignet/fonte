{"sha": "b5071c2f8bcaa96cc9efb0214b2896cc26996ca9", "log": "COMPRESS-351 CPIO InputStream sanitizes file names now", "commit": "\n--- a/src/main/java/org/apache/commons/compress/archivers/cpio/CpioArchiveInputStream.java\n+++ b/src/main/java/org/apache/commons/compress/archivers/cpio/CpioArchiveInputStream.java\n         final String name = readCString((int) namesize);\n         ret.setName(name);\n         if (CpioUtil.fileType(mode) == 0 && !name.equals(CPIO_TRAILER)){\n-            throw new IOException(\"Mode 0 only allowed in the trailer. Found entry name: \"+name + \" Occured at byte: \" + getBytesRead());\n+            throw new IOException(\"Mode 0 only allowed in the trailer. Found entry name: \"\n+                                  + ArchiveUtils.sanitize(name)\n+                                  + \" Occured at byte: \" + getBytesRead());\n         }\n         skip(ret.getHeaderPadCount());\n \n         final String name = readCString((int) namesize);\n         ret.setName(name);\n         if (CpioUtil.fileType(mode) == 0 && !name.equals(CPIO_TRAILER)){\n-            throw new IOException(\"Mode 0 only allowed in the trailer. Found entry: \"+ name + \" Occured at byte: \" + getBytesRead());\n+            throw new IOException(\"Mode 0 only allowed in the trailer. Found entry: \"\n+                                  + ArchiveUtils.sanitize(name)\n+                                  + \" Occured at byte: \" + getBytesRead());\n         }\n \n         return ret;\n         final String name = readCString((int) namesize);\n         ret.setName(name);\n         if (CpioUtil.fileType(mode) == 0 && !name.equals(CPIO_TRAILER)){\n-            throw new IOException(\"Mode 0 only allowed in the trailer. Found entry: \"+name + \"Occured at byte: \" + getBytesRead());\n+            throw new IOException(\"Mode 0 only allowed in the trailer. Found entry: \"\n+                                  + ArchiveUtils.sanitize(name)\n+                                  + \"Occured at byte: \" + getBytesRead());\n         }\n         skip(ret.getHeaderPadCount());\n ", "timestamp": 1465317970, "metainfo": ""}