{"sha": "6273f3a6b804aa845747c8859d659373b14199e1", "log": "COMPRESS-64: finish() does not close archive entries by default any longer  ", "commit": "\n--- a/src/main/java/org/apache/commons/compress/archivers/cpio/CpioArchiveOutputStream.java\n+++ b/src/main/java/org/apache/commons/compress/archivers/cpio/CpioArchiveOutputStream.java\n      */\n     public void close() throws IOException {\n         if (!this.closed) {\n-            this.finish();\n             out.close();\n             this.closed = true;\n         }\n--- a/src/main/java/org/apache/commons/compress/archivers/tar/TarArchiveOutputStream.java\n+++ b/src/main/java/org/apache/commons/compress/archivers/tar/TarArchiveOutputStream.java\n     }\n \n     /**\n-     * Ends the TAR archive and closes the underlying OutputStream.\n-     * This means that finish() is called followed by calling the\n-     * TarBuffer's close().\n+     * Closes the underlying OutputStream.\n      * @throws IOException on error\n      */\n     public void close() throws IOException {\n         if (!closed) {\n-            finish();\n             buffer.close();\n             out.close();\n             closed = true;\n--- a/src/main/java/org/apache/commons/compress/archivers/zip/ZipArchiveOutputStream.java\n+++ b/src/main/java/org/apache/commons/compress/archivers/zip/ZipArchiveOutputStream.java\n      * @exception  IOException  if an I/O error occurs.\n      */\n     public void close() throws IOException {\n-        finish();\n-\n         if (raf != null) {\n             raf.close();\n         }\n--- a/src/main/java/org/apache/commons/compress/changes/ChangeSetPerformer.java\n+++ b/src/main/java/org/apache/commons/compress/changes/ChangeSetPerformer.java\n     /**\n      * Performs all changes collected in this ChangeSet on the input stream and\n      * streams the result to the output stream. Perform may be called more than once.\n+     * \n+     * This method finishes the stream, no other entries should be added\n+     * after that.\n      * \n      * @param in\n      *            the InputStream to perform the changes on\n                 results.addedFromChangeSet(change.getEntry().getName());\n             }\n         }\n-        \n+        out.finish();\n         return results;\n     }\n \n--- a/src/test/java/org/apache/commons/compress/AbstractTestCase.java\n+++ b/src/test/java/org/apache/commons/compress/AbstractTestCase.java\n             addArchiveEntry(out, \"something/bla\", file6);\n             addArchiveEntry(out, \"test with spaces.txt\", file6);\n \n+            out.finish();\n             return archive;\n         } finally {\n             if (out != null) {\n             archive = File.createTempFile(\"empty\", \".\" + archivename);\n             stream = new FileOutputStream(archive);\n             out = factory.createArchiveOutputStream(archivename, stream);\n+            out.finish();\n         } finally {\n             if (out != null) {\n                 out.close();\n             out = factory.createArchiveOutputStream(archivename, stream);\n             // Use short file name so does not cause problems for ar\n             addArchiveEntry(out, \"test1.xml\", getFile(\"test1.xml\"));\n+            out.finish();\n         } finally {\n             if (out != null) {\n                 out.close();\n--- a/src/test/java/org/apache/commons/compress/archivers/CpioTestCase.java\n+++ b/src/test/java/org/apache/commons/compress/archivers/CpioTestCase.java\n             os.putArchiveEntry(entry);\n             IOUtils.copy(new FileInputStream(file2), os);\n             os.closeArchiveEntry();\n-\n+            os.finish();\n             os.close();\n             out.close();\n         }\n--- a/src/test/java/org/apache/commons/compress/archivers/jar/JarArchiveOutputStreamTest.java\n+++ b/src/test/java/org/apache/commons/compress/archivers/jar/JarArchiveOutputStreamTest.java\n             out.closeArchiveEntry();\n             out.putArchiveEntry(new ZipArchiveEntry(\"bar/\"));\n             out.closeArchiveEntry();\n+            out.finish();\n             out.close();\n             out = null;\n \n--- a/src/test/java/org/apache/commons/compress/archivers/zip/UTF8ZipFilesTest.java\n+++ b/src/test/java/org/apache/commons/compress/archivers/zip/UTF8ZipFilesTest.java\n             zos.putArchiveEntry(ze);\n             zos.write(\"ascii\".getBytes(\"US-ASCII\"));\n             zos.closeArchiveEntry();\n+            \n+            zos.finish();\n         } finally {\n             if (zos != null) {\n                 try {", "timestamp": 1240381569, "metainfo": ""}