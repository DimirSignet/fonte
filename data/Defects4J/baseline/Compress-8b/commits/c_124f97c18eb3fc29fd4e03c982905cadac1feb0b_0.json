{"sha": "124f97c18eb3fc29fd4e03c982905cadac1feb0b", "log": "improve error message for unparseable extra data.  COMPRESS-73  ", "commit": "\n--- a/src/main/java/org/apache/commons/compress/archivers/zip/ExtraFieldUtils.java\n+++ b/src/main/java/org/apache/commons/compress/archivers/zip/ExtraFieldUtils.java\n             ZipShort headerId = new ZipShort(data, start);\n             int length = (new ZipShort(data, start + 2)).getValue();\n             if (start + WORD + length > data.length) {\n-                throw new ZipException(\"data starting at \" + start\n-                    + \" is in unknown format\");\n+                throw new ZipException(\"bad extra field starting at \"\n+                                       + start + \".  Block length of \"\n+                                       + length + \" bytes exceeds remaining\"\n+                                       + \" data of \"\n+                                       + (data.length - start - WORD)\n+                                       + \" bytes.\");\n             }\n             try {\n                 ZipExtraField ze = createExtraField(headerId);\n--- a/src/test/java/org/apache/commons/compress/archivers/zip/ExtraFieldUtilsTest.java\n+++ b/src/test/java/org/apache/commons/compress/archivers/zip/ExtraFieldUtilsTest.java\n             fail(\"data should be invalid\");\n         } catch (Exception e) {\n             assertEquals(\"message\",\n-                         \"data starting at \"+(4+aLocal.length)+\" is in unknown format\",\n+                         \"bad extra field starting at \"+(4 + aLocal.length)\n+                         + \".  Block length of 1 bytes exceeds remaining data of 0 bytes.\",\n                          e.getMessage());\n         }\n     }", "timestamp": 1265974514, "metainfo": ""}