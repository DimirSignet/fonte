{"sha": "4e9b50467adf3ecb0390d20a5747ca60fe5da5e5", "log": "Additional test cases  ", "commit": "\n--- a/src/test/java/org/apache/commons/compress/changes/ChangeSetTestCase.java\n+++ b/src/test/java/org/apache/commons/compress/changes/ChangeSetTestCase.java\n         Iterator it = archiveList.iterator();\n         while(it.hasNext()){\n             String entry = (String) it.next();\n-            if (entry.equals(prefix) || entry.startsWith(prefix+\"/\")){\n+            if (entry.startsWith(prefix+\"/\")){ // TODO won't work with folders\n                 it.remove();\n             }\n         }\n     }\n \n     /**\n+     * Tries to delete the folder \"test.txt\" from an archive file.\n+     * This should not match any files/folders.\n+     * \n+     * @throws Exception\n+     */\n+    public void testDeleteDir3() throws Exception {\n+        final String archivename = \"cpio\";\n+        File input = this.createArchive(archivename);\n+\n+        ArchiveOutputStream out = null;\n+        ArchiveInputStream ais = null;\n+        File result = File.createTempFile(\"test\", \".\"+archivename);\n+        result.deleteOnExit();\n+        try {\n+\n+            final InputStream is = new FileInputStream(input);\n+            ais = factory.createArchiveInputStream(archivename, is);\n+\n+            out = factory.createArchiveOutputStream(archivename,\n+                    new FileOutputStream(result));\n+\n+            ChangeSet changes = new ChangeSet();\n+            changes.deleteDir(\"test.txt\");\n+            archiveListDeleteDir(\"test.txt\");\n+            ChangeSetPerformer performer = new ChangeSetPerformer(changes);\n+            performer.perform(ais, out);\n+            is.close();\n+\n+        } finally {\n+            if (out != null)\n+                out.close();\n+            if (ais != null)\n+                ais.close();\n+        }\n+\n+        this.checkArchiveContent(result, archiveList);\n+    }\n+\n+    /**\n      * Tries to delete the file \"bla/test5.xml\" from an archive. This should\n      * result in the deletion of \"bla/test5.xml\".\n      * \n             ChangeSet changes = new ChangeSet();\n             changes.delete(\"bla/test5.xml\");\n             archiveListDelete(\"bla/test5.xml\");\n+            \n+            ChangeSetPerformer performer = new ChangeSetPerformer(changes);\n+            performer.perform(ais, out);\n+            is.close();\n+\n+        } finally {\n+            if (out != null)\n+                out.close();\n+            if (ais != null)\n+                ais.close();\n+        }\n+\n+        this.checkArchiveContent(result, archiveList);\n+    }\n+\n+    /**\n+     * Tries to delete the file \"bla\" from an archive. This should\n+     * result in the deletion of nothing.\n+     * \n+     * @throws Exception\n+     */\n+    public void testDeleteFile2() throws Exception {\n+        final String archivename = \"cpio\";\n+        File input = this.createArchive(archivename);\n+\n+        ArchiveOutputStream out = null;\n+        ArchiveInputStream ais = null;\n+        File result = File.createTempFile(\"test\", \".\"+archivename);\n+        result.deleteOnExit();\n+        try {\n+\n+            final InputStream is = new FileInputStream(input);\n+            ais = factory.createArchiveInputStream(archivename, is);\n+\n+            out = factory.createArchiveOutputStream(archivename,\n+                    new FileOutputStream(result));\n+\n+            ChangeSet changes = new ChangeSet();\n+            changes.delete(\"bla\");\n+            //archiveListDelete(\"bla\");\n             \n             ChangeSetPerformer performer = new ChangeSetPerformer(changes);\n             performer.perform(ais, out);", "timestamp": 1239802306, "metainfo": ""}