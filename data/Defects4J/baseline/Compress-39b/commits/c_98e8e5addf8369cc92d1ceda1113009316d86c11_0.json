{"sha": "98e8e5addf8369cc92d1ceda1113009316d86c11", "log": "testcase for COMPRESS-84  ", "commit": "\n--- a/src/test/java/org/apache/commons/compress/compressors/GZipTestCase.java\n+++ b/src/test/java/org/apache/commons/compress/compressors/GZipTestCase.java\n import java.io.File;\n import java.io.FileInputStream;\n import java.io.FileOutputStream;\n+import java.io.IOException;\n import java.io.InputStream;\n import java.io.OutputStream;\n \n             is.close();\n         }\n     }\n+\n+    /**\n+     * @see https://issues.apache.org/jira/browse/COMPRESS-84\n+     */\n+    public void testCorruptedInput() throws Exception {\n+        InputStream in = null;\n+        OutputStream out = null;\n+        CompressorInputStream cin = null;\n+        try {\n+            in = new FileInputStream(getFile(\"bla.tgz\"));\n+            out = new ByteArrayOutputStream();\n+            IOUtils.copy(in, out);\n+            in.close();\n+            out.close();\n+\n+            byte[] data = ((ByteArrayOutputStream) out).toByteArray();\n+            in = new ByteArrayInputStream(data, 0, data.length - 1);\n+            cin = new CompressorStreamFactory()\n+                .createCompressorInputStream(\"gz\", in);\n+            out = new ByteArrayOutputStream();\n+\n+            try {\n+                IOUtils.copy(cin, out);\n+                fail(\"Expected an exception\");\n+            } catch (IOException ioex) {\n+                // the whole point of the test\n+            }\n+\n+        } finally {\n+            if (out != null) {\n+                out.close();\n+            }\n+            if (cin != null) {\n+                in.close();\n+            }\n+            if (in != null) {\n+                in.close();\n+            }\n+        }\n+    }\n }", "timestamp": 1267537231, "metainfo": ""}