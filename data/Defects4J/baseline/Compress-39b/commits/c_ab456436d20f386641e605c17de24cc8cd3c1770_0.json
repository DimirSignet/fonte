{"sha": "ab456436d20f386641e605c17de24cc8cd3c1770", "log": "COMPRESS-197: Tar file for Android backup cannot be read  Allow more than one or two NUL or space characters at the end of a field  ", "commit": "\n--- a/src/main/java/org/apache/commons/compress/archivers/tar/TarUtils.java\n+++ b/src/main/java/org/apache/commons/compress/archivers/tar/TarUtils.java\n             throw new IllegalArgumentException(\n                     exceptionMessage(buffer, offset, length, end-1, trailer));\n         }\n-        // May have additional NUL or space\n-        trailer = buffer[end-1];\n-        if (trailer == 0 || trailer == ' '){\n+        // May have additional NULs or spaces\n+        trailer = buffer[end - 1];\n+        while (start < end - 1 && (trailer == 0 || trailer == ' ')) {\n             end--;\n+            trailer = buffer[end - 1];\n         }\n \n         for ( ;start < end; start++) {\n--- a/src/test/java/org/apache/commons/compress/archivers/tar/TarArchiveInputStreamTest.java\n+++ b/src/test/java/org/apache/commons/compress/archivers/tar/TarArchiveInputStreamTest.java\n \n import static org.junit.Assert.assertEquals;\n import static org.junit.Assert.assertTrue;\n+import static org.junit.Assert.fail;\n \n import java.io.ByteArrayInputStream;\n import java.io.File;\n import java.io.FileInputStream;\n+import java.io.IOException;\n import java.net.URI;\n import java.net.URL;\n import java.util.Calendar;\n         }\n     }\n \n-}\n+    @Test\n+    public void testCompress197() throws Exception {\n+        TarArchiveInputStream tar = getTestStream(\"/COMPRESS-197.tar\");\n+        try {\n+            TarArchiveEntry entry = tar.getNextTarEntry();\n+            while (entry != null) {\n+                entry = tar.getNextTarEntry();\n+            }\n+        } catch (IOException e) {\n+            fail(\"COMPRESS-197: \" + e.getMessage());\n+        } finally {\n+            tar.close();\n+        }\n+    }\n+\n+    private TarArchiveInputStream getTestStream(String name) {\n+        return new TarArchiveInputStream(\n+                TarArchiveInputStreamTest.class.getResourceAsStream(name));\n+    }\n+\n+}", "timestamp": 1344196275, "metainfo": ""}