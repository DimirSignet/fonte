{"sha": "e860d2f3eb16d84e146a8a700d9dbd3af01df4ba", "log": "COMPRESS-228 be more lenient when parsing zip64 extra field  ", "commit": "\n--- a/src/main/java/org/apache/commons/compress/archivers/zip/Zip64ExtendedInformationExtraField.java\n+++ b/src/main/java/org/apache/commons/compress/archivers/zip/Zip64ExtendedInformationExtraField.java\n      * field with knowledge which fields are expected to be there.\n      *\n      * <p>All four fields inside the zip64 extended information extra\n-     * field are optional and only present if their corresponding\n+     * field are optional and must only be present if their corresponding\n      * entry inside the central directory contains the correct magic\n      * value.</p>\n      */\n                 + (hasCompressedSize ? DWORD : 0)\n                 + (hasRelativeHeaderOffset ? DWORD : 0)\n                 + (hasDiskStart ? WORD : 0);\n-            if (rawCentralDirectoryData.length != expectedLength) {\n+            if (rawCentralDirectoryData.length < expectedLength) {\n                 throw new ZipException(\"central directory zip64 extended\"\n                                        + \" information extra field's length\"\n                                        + \" doesn't match central directory\"\n--- a/src/test/java/org/apache/commons/compress/archivers/zip/ZipFileTest.java\n+++ b/src/test/java/org/apache/commons/compress/archivers/zip/ZipFileTest.java\n         assertEquals(2, numberOfEntries);\n     }\n \n+    /**\n+     * @see https://issues.apache.org/jira/browse/COMPRESS-228\n+     */\n+    public void testExcessDataInZip64ExtraField() throws Exception {\n+        File archive = getFile(\"COMPRESS-228.zip\");\n+        zf = new ZipFile(archive);\n+        // actually, if we get here, the test already has passed\n+\n+        ZipArchiveEntry ze = zf.getEntry(\"src/main/java/org/apache/commons/compress/archivers/zip/ZipFile.java\");\n+        assertEquals(26101, ze.getSize());\n+    }\n+\n     /*\n      * ordertest.zip has been handcrafted.\n      *", "timestamp": 1369589795, "metainfo": ""}