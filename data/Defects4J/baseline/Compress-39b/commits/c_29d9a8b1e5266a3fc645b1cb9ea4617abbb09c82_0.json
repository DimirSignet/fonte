{"sha": "29d9a8b1e5266a3fc645b1cb9ea4617abbb09c82", "log": "COMPRESS-229 aftermaths, properly deal with broken archives that end with an incomplete entry.  Unfortunately we don't have a test for this  ", "commit": "\n--- a/src/main/java/org/apache/commons/compress/archivers/tar/TarArchiveInputStream.java\n+++ b/src/main/java/org/apache/commons/compress/archivers/tar/TarArchiveInputStream.java\n \n         if (currEntry.isGNULongLinkEntry()) {\n             byte[] longLinkData = getLongNameData();\n+            if (longLinkData == null) {\n+                // Bugzilla: 40334\n+                // Malformed tar file - long link entry name not followed by\n+                // entry\n+                return null;\n+            }\n             currEntry.setLinkName(encoding.decode(longLinkData));\n         }\n \n         if (currEntry.isGNULongNameEntry()) {\n             byte[] longNameData = getLongNameData();\n+            if (longNameData == null) {\n+                // Bugzilla: 40334\n+                // Malformed tar file - long entry name not followed by\n+                // entry\n+                return null;\n+            }\n             currEntry.setName(encoding.decode(longNameData));\n         }\n ", "timestamp": 1370253507, "metainfo": ""}