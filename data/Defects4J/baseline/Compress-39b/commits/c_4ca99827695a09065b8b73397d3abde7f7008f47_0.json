{"sha": "4ca99827695a09065b8b73397d3abde7f7008f47", "log": "Fixup tests - should only allow at most 11 octal digits in 12-byte buffer  ", "commit": "\n--- a/src/test/java/org/apache/commons/compress/archivers/tar/TarUtilsTest.java\n+++ b/src/test/java/org/apache/commons/compress/archivers/tar/TarUtilsTest.java\n         assertEquals(sb1, sb2);\n     }\n     \n-    private void fillBuff(byte []buffer, String input) throws Exception{\n-        for(int i=0; i<buffer.length;i++){\n-            buffer[i]=0;\n-        }\n-        System.arraycopy(input.getBytes(\"UTF-8\"),0,buffer,0,Math.min(buffer.length,input.length()));        \n-    }\n-\n     public void testParseOctal() throws Exception{\n-        byte [] buffer = new byte[20];\n-        fillBuff(buffer,\"777777777777 \");\n         long value; \n-        value = TarUtils.parseOctal(buffer,0, 11);\n-        assertEquals(077777777777L, value);\n-        value = TarUtils.parseOctal(buffer,0, 12);\n-        assertEquals(0777777777777L, value);\n-        buffer[11]=' ';\n-        value = TarUtils.parseOctal(buffer,0, 11);\n-        assertEquals(077777777777L, value);\n-        buffer[11]=0;\n-        value = TarUtils.parseOctal(buffer,0, 11);\n-        assertEquals(077777777777L, value);\n-        fillBuff(buffer, \"abcdef\"); // Invalid input\n+        byte [] buffer;\n+        final long MAX_OCTAL  = 077777777777L; // Allowed 11 digits\n+        final String maxOctal = \"77777777777 \"; // Maximum valid octal\n+        buffer = maxOctal.getBytes(\"UTF-8\");\n+        value = TarUtils.parseOctal(buffer,0, buffer.length);\n+        assertEquals(MAX_OCTAL, value);\n+        buffer[buffer.length-1]=0;\n+        value = TarUtils.parseOctal(buffer,0, buffer.length);\n+        assertEquals(MAX_OCTAL, value);\n+        buffer = \"abcdef\".getBytes(\"UTF-8\"); // Invalid input\n         try {\n-            value = TarUtils.parseOctal(buffer,0, 11);\n+            TarUtils.parseOctal(buffer,0, buffer.length);\n             fail(\"Expected IllegalArgumentException\");\n         } catch (IllegalArgumentException expected) {\n         }", "timestamp": 1275405593, "metainfo": ""}