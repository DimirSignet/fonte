{"sha": "7250daa429020181bb5a4c40d1aaa169631b8496", "log": "COMPRESS-335 yet another strange case of tar checksum", "commit": "\n--- a/src/main/java/org/apache/commons/compress/archivers/tar/TarUtils.java\n+++ b/src/main/java/org/apache/commons/compress/archivers/tar/TarUtils.java\n      * @since 1.5\n      */\n     public static boolean verifyCheckSum(byte[] header) {\n-        long storedSum = 0;\n+        long storedSum = parseOctal(header, CHKSUM_OFFSET, CHKSUMLEN);\n         long unsignedSum = 0;\n         long signedSum = 0;\n \n         for (int i = 0; i < header.length; i++) {\n             byte b = header[i];\n             if (CHKSUM_OFFSET  <= i && i < CHKSUM_OFFSET + CHKSUMLEN) {\n-                if ('0' <= b && b <= '7' && digits++ < 6) {\n-                    storedSum = storedSum * 8 + b - '0';\n-                } else if (digits > 0) {\n-                    digits = 6; // only look at the first octal digit sequence\n-                }\n                 b = ' ';\n             }\n             unsignedSum += 0xff & b;\n--- a/src/test/java/org/apache/commons/compress/DetectArchiverTestCase.java\n+++ b/src/test/java/org/apache/commons/compress/DetectArchiverTestCase.java\n     @Test\n     public void testCOMPRESS117() throws Exception {\n         final ArchiveInputStream tar = getStreamFor(\"COMPRESS-117.tar\");\n+        assertNotNull(tar);\n+        assertTrue(tar instanceof TarArchiveInputStream);\n+    }\n+\n+    @Test\n+    public void testCOMPRESS335() throws Exception {\n+        final ArchiveInputStream tar = getStreamFor(\"COMPRESS-335.tar\");\n         assertNotNull(tar);\n         assertTrue(tar instanceof TarArchiveInputStream);\n     }", "timestamp": 1454703619, "metainfo": ""}