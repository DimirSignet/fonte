{"sha": "8f4f620ebc773ac935157e9319ea3989fd84110d", "log": "Change on 2010/07/09 16:42:20 by nicksantos  \tMake CollapseAnonymousFunction normalized.  \tR=johnlenz \tDELTA=17  (17 added, 0 deleted, 0 changed)  Change on 2010/07/09 18:02:18 by nicksantos  \tbuild kung-fu for putting autogenerated maps v3 externs \tinto svn.  \tR=acleung \tDELTA=6239  (3123 added, 3114 deleted, 2 changed)   Revision created by MOE tool push_codebase. MOE_MIGRATION=48006   ", "commit": "\n--- a/src/com/google/javascript/jscomp/CollapseAnonymousFunctions.java\n+++ b/src/com/google/javascript/jscomp/CollapseAnonymousFunctions.java\n         NodeUtil.copyNameAnnotations(name, fnName);\n         name.removeChild(value);\n         parent.replaceChild(n, value);\n+\n+        // Renormalize the code.\n+        if (!t.inGlobalScope() &&\n+            NodeUtil.isHoistedFunctionDeclaration(value)) {\n+          parent.addChildToFront(value.detachFromParent());\n+        }\n+\n         compiler.reportCodeChange();\n       }\n     }\n--- a/test/com/google/javascript/jscomp/CollapseAnonymousFunctionsTest.java\n+++ b/test/com/google/javascript/jscomp/CollapseAnonymousFunctionsTest.java\n     test(\"var FOO = function(){};FOO()\",\n          \"function FOO(){}FOO()\");\n   }\n+\n+  public void testInnerFunction1() {\n+    test(\n+        \"function f() { \" +\n+        \"  var x = 3; var y = function() { return 4; }; return x + y();\" +\n+        \"}\",\n+        \"function f() { \" +\n+        \"  function y() { return 4; } var x = 3; return x + y();\" +\n+        \"}\");\n+  }\n }", "timestamp": 1278733527, "metainfo": ""}