{"sha": "4b5d62920ef4606fd30dfa42eb72df2785415533", "log": "don't print the externs files in --print_ast.  R=acleung DELTA=23  (18 added, 3 deleted, 2 changed)   Revision created by MOE tool push_codebase. MOE_MIGRATION=235672   ", "commit": "\n--- a/src/com/google/javascript/jscomp/AbstractCommandLineRunner.java\n+++ b/src/com/google/javascript/jscomp/AbstractCommandLineRunner.java\n     int errCode = processResults(result, modules, options);\n     // Close the output if we are writing to a file.\n     if (out instanceof Closeable) {\n-      ((Closeable)out).close();\n+      ((Closeable) out).close();\n     }\n     return errCode;\n   }\n         return 1;\n       } else {\n         ControlFlowGraph<Node> cfg = compiler.computeCFG();\n-        DotFormatter.appendDot(compiler.getRoot(), cfg, out);\n+        DotFormatter.appendDot(compiler.getRoot().getLastChild(), cfg, out);\n         out.append('\\n');\n         return 0;\n       }\n--- a/test/com/google/javascript/jscomp/CommandLineRunnerTest.java\n+++ b/test/com/google/javascript/jscomp/CommandLineRunnerTest.java\n   }\n \n   public void testSourceMapExpansion1() {\n+    args.add(\"--js_output_file\");\n+    args.add(\"/path/to/out.js\");\n     args.add(\"--create_source_map=%outname%.map\");\n     testSame(\"var x = 3;\");\n     assertEquals(\"/path/to/out.js.map\",\n             \"Built on:\"));\n   }\n \n+  public void testPrintAstFlag() {\n+    args.add(\"--print_ast=true\");\n+    testSame(\"\");\n+    assertEquals(\n+        \"digraph AST {\\n\" +\n+        \"  node [color=lightblue2, style=filled];\\n\" +\n+        \"  node0 [label=\\\"BLOCK\\\"];\\n\" +\n+        \"  node1 [label=\\\"SCRIPT\\\"];\\n\" +\n+        \"  node0 -> node1 [weight=1];\\n\" +\n+        \"  node1 -> RETURN [label=\\\"UNCOND\\\", fontcolor=\\\"red\\\", weight=0.01, color=\\\"red\\\"];\\n\" +\n+        \"  node0 -> RETURN [label=\\\"SYN_BLOCK\\\", fontcolor=\\\"red\\\", weight=0.01, color=\\\"red\\\"];\\n\" +\n+        \"  node0 -> node1 [label=\\\"UNCOND\\\", fontcolor=\\\"red\\\", weight=0.01, color=\\\"red\\\"];\\n\" +\n+        \"}\\n\\n\",\n+        new String(outReader.toByteArray()));\n+  }\n+\n   /* Helper functions */\n \n   private void testSame(String original) {\n   }\n \n   private CommandLineRunner createCommandLineRunner(String[] original) {\n-    args.add(\"--js_output_file\");\n-    args.add(\"/path/to/out.js\");\n-\n     for (int i = 0; i < original.length; i++) {\n       args.add(\"--js\");\n       args.add(\"/path/to/input\" + i + \".js\");", "timestamp": 1285043751, "metainfo": ""}