{"sha": "9f41fc2ceda896faf7f5c5aabede4f2b0c48433c", "log": "wow, people put crazy stuff in externs files.  R=avd DELTA=24  (18 added, 0 deleted, 6 changed)   Revision created by MOE tool push_codebase. MOE_MIGRATION=176074   ", "commit": "\n--- a/src/com/google/javascript/jscomp/SimpleDefinitionFinder.java\n+++ b/src/com/google/javascript/jscomp/SimpleDefinitionFinder.java\n           boolean dropStub = false;\n           if (node.getJSDocInfo() == null) {\n             String qualifiedName = node.getQualifiedName();\n-            for (Definition prevDef : nameDefinitionMultimap.get(name)) {\n-              String prevName = prevDef.getLValue().getQualifiedName();\n-              if (qualifiedName.equals(prevName)) {\n-                dropStub = true;\n-                break;\n+            if (qualifiedName != null) {\n+              for (Definition prevDef : nameDefinitionMultimap.get(name)) {\n+                String prevName = prevDef.getLValue().getQualifiedName();\n+                if (qualifiedName.equals(prevName)) {\n+                  dropStub = true;\n+                  break;\n+                }\n               }\n             }\n           }\n--- a/test/com/google/javascript/jscomp/SimpleDefinitionFinderTest.java\n+++ b/test/com/google/javascript/jscomp/SimpleDefinitionFinderTest.java\n         \"/** @type {number} */ goog.HYBRID;\" +\n         \"/** @enum */ goog.Enum = {HYBRID: 0, ROADMAP: 1};\",\n         \"goog.HYBRID; goog.Enum.ROADMAP;\",\n-        ImmutableSet.<String>of(\n+        ImmutableSet.of(\n             \"DEF GETPROP goog.Enum -> EXTERN <null>\",\n             \"DEF GETPROP goog.HYBRID -> EXTERN <null>\",\n             \"DEF NAME goog -> EXTERN <null>\",\n             \"USE GETPROP goog.Enum -> [EXTERN <null>]\",\n             \"USE GETPROP goog.Enum.ROADMAP -> [EXTERN NUMBER]\",\n             \"USE GETPROP goog.HYBRID -> [EXTERN <null>, EXTERN NUMBER]\",\n+            \"USE NAME goog -> [EXTERN <null>]\"));\n+  }\n+\n+  public void testCallInExterns() {\n+    checkDefinitionsInExterns(\n+        \"var goog = {};\" +\n+        \"/** @constructor */ goog.Response = function() {};\" +\n+        \"goog.Response.prototype.get;\" +\n+        \"goog.Response.prototype.get().get;\",\n+        ImmutableSet.of(\n+            \"DEF GETPROP goog.Response -> EXTERN FUNCTION\",\n+            \"DEF GETPROP goog.Response.prototype.get -> EXTERN <null>\",\n+            \"DEF GETPROP null -> EXTERN <null>\",\n+            \"DEF NAME goog -> EXTERN <null>\",\n+            \"USE GETPROP goog.Response -> [EXTERN FUNCTION]\",\n+            \"USE GETPROP goog.Response.prototype.get -> [EXTERN <null> x 2]\",\n             \"USE NAME goog -> [EXTERN <null>]\"));\n   }\n ", "timestamp": 1282604833, "metainfo": ""}