{"sha": "ce53ac0eb979bedc052b7cb699281b913752d425", "log": "better error messaging in ReplaceCssNames  R=acleung DELTA=13  (5 added, 5 deleted, 3 changed)   Revision created by MOE tool push_codebase. MOE_MIGRATION=2880   ", "commit": "\n--- a/src/com/google/javascript/jscomp/ReplaceCssNames.java\n+++ b/src/com/google/javascript/jscomp/ReplaceCssNames.java\n \n             Node second = first.getNext();\n \n-            if (first.getType() == Token.STRING) {\n+            if (second.getType() != Token.STRING) {\n+              compiler.report(t.makeError(n, STRING_LITERAL_EXPECTED_ERROR,\n+                  Token.name(second.getType())));\n+            } else if (first.getType() == Token.STRING) {\n               compiler.report(t.makeError(\n                   n, UNEXPECTED_STRING_LITERAL_ERROR,\n                   first.getString(), second.getString()));\n-\n-            } else if (second.getType() == Token.STRING) {\n+            } else {\n               processStringNode(t, second);\n               n.removeChild(first);\n               Node replacement = new Node(Token.ADD, first,\n               replacement.setJSType(nativeStringType);\n               parent.replaceChild(n, replacement);\n               compiler.reportCodeChange();\n-\n-            } else {\n-              compiler.report(t.makeError(n, STRING_LITERAL_EXPECTED_ERROR,\n-                  Token.name(second.getType())));\n             }\n             break;\n \n--- a/test/com/google/javascript/jscomp/ReplaceCssNamesTest.java\n+++ b/test/com/google/javascript/jscomp/ReplaceCssNamesTest.java\n     test(\"var x = goog.getCssName('header', 'active')\",\n          null, UNEXPECTED_STRING_LITERAL_ERROR);\n     test(\"el.className = goog.getCssName('footer', window)\",\n-         null, UNEXPECTED_STRING_LITERAL_ERROR);\n+         null, ReplaceCssNames.STRING_LITERAL_EXPECTED_ERROR);\n     test(\"setClass(goog.getCssName('buttonbar', 'disabled'))\",\n          null, UNEXPECTED_STRING_LITERAL_ERROR);\n     test(\"setClass(goog.getCssName(goog.getCssName('buttonbar'), 'active'))\",\n     test(\"goog.getCssName(baseClass, null);\", null,\n         ReplaceCssNames.STRING_LITERAL_EXPECTED_ERROR);\n     test(\"goog.getCssName(baseClass, undefined);\", null,\n+        ReplaceCssNames.STRING_LITERAL_EXPECTED_ERROR);\n+    test(\"goog.getCssName('foo', 3);\", null,\n         ReplaceCssNames.STRING_LITERAL_EXPECTED_ERROR);\n   }\n ", "timestamp": 1312392526, "metainfo": ""}