{"sha": "743a2d7d694f4608e3a531c73690503745d39ed7", "log": "Don't expose static arrays to potential writes, even for testing Add package protected read method instead  ", "commit": "\n--- a/src/java/org/apache/commons/lang/Entities.java\n+++ b/src/java/org/apache/commons/lang/Entities.java\n     private static final String[][] APOS_ARRAY = {{\"apos\", \"39\"}, // XML apostrophe\n     };\n \n-    // package scoped for testing\n-    static final String[][] ISO8859_1_ARRAY = {{\"nbsp\", \"160\"}, // non-breaking space\n+    private static final String[][] ISO8859_1_ARRAY = {{\"nbsp\", \"160\"}, // non-breaking space\n         {\"iexcl\", \"161\"}, // inverted exclamation mark\n         {\"cent\", \"162\"}, // cent sign\n         {\"pound\", \"163\"}, // pound sign\n         {\"yuml\", \"255\"}, //  - lowercase y, umlaut\n     };\n \n+    // package scoped for testing\n+    static int ISO8859_1_ARRAY_LENGTH = ISO8859_1_ARRAY.length;\n+    \n+    static String getISO8859_1(int i, int j) {\n+        return ISO8859_1_ARRAY[i][j];\n+    }\n+\n     // http://www.w3.org/TR/REC-html40/sgml/entities.html\n-    // package scoped for testing\n-    static final String[][] HTML40_ARRAY = {\n+    private static final String[][] HTML40_ARRAY = {\n     // <!-- Latin Extended-B -->\n         {\"fnof\", \"402\"}, // latin small f with hook = function= florin, U+0192 ISOtech -->\n         // <!-- Greek -->\n         // <!-- rsaquo is proposed but not yet ISO standardized -->\n         {\"euro\", \"8364\"}, // -- euro sign, U+20AC NEW -->\n     };\n+    \n+    // package scoped for testing\n+    static int HTML40_ARRAY_LENGTH = HTML40_ARRAY.length;\n+    \n+    static String getHTML40(int i, int j) {\n+        return HTML40_ARRAY[i][j];\n+    }\n \n     /**\n      * <p>\n     }\n \n     static class PrimitiveEntityMap implements EntityMap {\n-        private Map mapNameToValue = new HashMap();\n-\n-        private IntHashMap mapValueToName = new IntHashMap();\n+        private final Map mapNameToValue = new HashMap();\n+\n+        private final IntHashMap mapValueToName = new IntHashMap();\n \n         /**\n          * {@inheritDoc}\n--- a/src/test/org/apache/commons/lang/EntitiesPerformanceTest.java\n+++ b/src/test/org/apache/commons/lang/EntitiesPerformanceTest.java\n     }\n \n     private char html40value(int i) {\n-        String entityValue = Entities.HTML40_ARRAY[i % Entities.HTML40_ARRAY.length][1];\n+        String entityValue = Entities.getHTML40(i % Entities.HTML40_ARRAY_LENGTH, 1);\n         char ch = (char) Integer.parseInt(entityValue);\n         return ch;\n     }\n \n     private char isovalue(int i) {\n-        String entityValue = Entities.ISO8859_1_ARRAY[i % Entities.ISO8859_1_ARRAY.length][1];\n+        String entityValue = Entities.getISO8859_1(i % Entities.ISO8859_1_ARRAY_LENGTH, 1);\n         char ch = (char) Integer.parseInt(entityValue);\n         return ch;\n     }", "timestamp": 1237115910, "metainfo": ""}