{"sha": "25cec7ac110d1e976744cdcdb8a5bdf8da22828f", "log": "Replacing the escaped quote with CSV_QUOTE, and changing the non-Writer version to reuse the Writer version - See: LANG-374  ", "commit": "\n--- a/src/java/org/apache/commons/lang/StringEscapeUtils.java\n+++ b/src/java/org/apache/commons/lang/StringEscapeUtils.java\n  */\n public class StringEscapeUtils {\n \n-    private static final char[] CSV_SEARCH_CHARS = new char[] {',', '\"', CharUtils.CR, CharUtils.LF};\n+    private static final char CSV_DELIMITER = ',';\n+    private static final char CSV_QUOTE = '\"';\n+    private static final char[] CSV_SEARCH_CHARS = new char[] {CSV_DELIMITER, CSV_QUOTE, CharUtils.CR, CharUtils.LF};\n \n     /**\n      * <p><code>StringEscapeUtils</code> instances should NOT be constructed in\n         if (StringUtils.containsNone(str, CSV_SEARCH_CHARS)) {\n             return str;\n         }\n-        StringBuffer buffer = new StringBuffer(str.length() + 10);\n-        buffer.append('\"');\n-        for (int i = 0; i < str.length(); i++) {\n-            char c = str.charAt(i);\n-            if (c == '\"') {\n-                buffer.append('\"'); // escape double quote\n-            }\n-            buffer.append(c);\n-        }\n-        buffer.append('\"');\n-        return buffer.toString();\n+        try {\n+            StringWriter writer = new StringWriter();\n+            escapeCsv(writer, str);\n+            return writer.toString();\n+        } catch (IOException ioe) {\n+            // this should never ever happen while writing to a StringWriter\n+            ioe.printStackTrace();\n+            return null;\n+        }\n     }\n \n     /**\n             }\n             return;\n         }\n-        out.write('\"');\n+        out.write(CSV_QUOTE);\n         for (int i = 0; i < str.length(); i++) {\n             char c = str.charAt(i);\n-            if (c == '\"') {\n-                out.write('\"'); // escape double quote\n+            if (c == CSV_QUOTE) {\n+                out.write(CSV_QUOTE); // escape double quote\n             }\n             out.write(c);\n         }\n-        out.write('\"');\n+        out.write(CSV_QUOTE);\n     }\n \n }", "timestamp": 1195694799, "metainfo": ""}