{"sha": "cccb85065f352d69f5c7bb15f31ece81f734c18d", "log": "Don't create a statement outside a SCRIPT node.  R=acleung DELTA=11  (10 added, 0 deleted, 1 changed)   Revision created by MOE tool push_codebase. MOE_MIGRATION=1313   ", "commit": "\n--- a/src/com/google/javascript/jscomp/ObjectPropertyStringPreprocess.java\n+++ b/src/com/google/javascript/jscomp/ObjectPropertyStringPreprocess.java\n   }\n \n   public void process(Node externs, Node root) {\n-    externs.addChildToBack(\n+    addExternDeclaration(externs,\n         new Node(Token.VAR,\n             Node.newString(Token.NAME, EXTERN_OBJECT_PROPERTY_STRING)));\n     NodeTraversal.traverse(compiler, root, new Callback());\n+  }\n+\n+  private void addExternDeclaration(Node externs, Node declarationStmt) {\n+    Node script = externs.getLastChild();\n+    if (script == null || script.getType() != Token.SCRIPT) {\n+      script = new Node(Token.SCRIPT);\n+      script.setIsSyntheticBlock(true);\n+      externs.addChildToBack(script);\n+    }\n+    script.addChildToBack(declarationStmt);\n   }\n \n   private class Callback extends AbstractPostOrderCallback {", "timestamp": 1302540066, "metainfo": ""}