{"sha": "3a6ea49cc7aecb2a0f1e948313123751641ef149", "log": "Instanceof checks should not prevent the collapsing of a namespace. ------------- Created by MOE: http://code.google.com/p/moe-java MOE_MIGRATED_REVID=50120042", "commit": "\n--- a/src/com/google/javascript/jscomp/GlobalNamespace.java\n+++ b/src/com/google/javascript/jscomp/GlobalNamespace.java\n       if (parent != null) {\n         switch (parent.getType()) {\n           case Token.IF:\n+          case Token.INSTANCEOF:\n           case Token.TYPEOF:\n           case Token.VOID:\n           case Token.NOT:\n       Node prev = parent;\n       for (Node anc : parent.getAncestors()) {\n         switch (anc.getType()) {\n+          case Token.INSTANCEOF:\n           case Token.EXPR_RESULT:\n           case Token.VAR:\n           case Token.IF:\n--- a/test/com/google/javascript/jscomp/CollapsePropertiesTest.java\n+++ b/test/com/google/javascript/jscomp/CollapsePropertiesTest.java\n         \"use(blob.init)\",\n         null);\n   }\n+\n+  public void testLocalAliasOfEnumWithInstanceofCheck() {\n+    test(\n+        \"/** @constructor */\\n\" +\n+        \"var Enums = function() {\\n\" +\n+        \"};\\n\" +\n+        \"\\n\" +\n+        \"/** @enum {number} */\\n\" +\n+        \"Enums.Fruit = {\\n\" +\n+        \" APPLE: 1,\\n\" +\n+        \" BANANA: 2,\\n\" +\n+        \"};\\n\" +\n+        \"\\n\" +\n+        \"function foo(f) {\\n\" +\n+        \" if (f instanceof Enums) { alert('what?'); return; }\\n\" +\n+        \"\\n\" +\n+        \" var Fruit = Enums.Fruit;\\n\" +\n+        \" if (f == Fruit.APPLE) alert('apple');\\n\" +\n+        \" if (f == Fruit.BANANA) alert('banana');\\n\" +\n+        \"}\",\n+        \"var Enums = function() {};\\n\" +\n+        \"var Enums$Fruit$APPLE = 1;\\n\" +\n+        \"var Enums$Fruit$BANANA = 2;\\n\" +\n+        \"function foo(f) {\\n\" +\n+        \" if (f instanceof Enums) { alert('what?'); return; }\\n\" +\n+        \" var Fruit = null;\\n\" +\n+        \" if (f == Enums$Fruit$APPLE) alert('apple');\\n\" +\n+        \" if (f == Enums$Fruit$BANANA) alert('banana');\\n\" +\n+        \"}\",\n+        null);\n+  }\n }", "timestamp": 1375753461, "metainfo": ""}