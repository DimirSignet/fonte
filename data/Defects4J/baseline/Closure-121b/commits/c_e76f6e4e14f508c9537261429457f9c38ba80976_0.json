{"sha": "e76f6e4e14f508c9537261429457f9c38ba80976", "log": "Add fusion into blocks, as John suggested. ------------- Created by MOE: http://code.google.com/p/moe-java MOE_MIGRATED_REVID=45680795", "commit": "\n--- a/src/com/google/javascript/jscomp/StatementFusion.java\n+++ b/src/com/google/javascript/jscomp/StatementFusion.java\n         }\n       case Token.LABEL:\n         return isFusableControlStatement(n.getLastChild());\n+      case Token.BLOCK:\n+        return isFusableControlStatement(n.getFirstChild());\n     }\n     return false;\n   }\n       case Token.LABEL:\n         fuseExpressionIntoControlFlowStatement(before, control.getLastChild());\n         return;\n+      case Token.BLOCK:\n+        fuseExpressionIntoControlFlowStatement(before, control.getFirstChild());\n+        return;\n       default:\n         throw new IllegalStateException(\"Statement fusion missing.\");\n     }\n--- a/test/com/google/javascript/jscomp/StatementFusionTest.java\n+++ b/test/com/google/javascript/jscomp/StatementFusionTest.java\n     fuseSame(\"a;b;c;label:while(true){}\");\n   }\n \n+  public void testFuseIntoBlock() {\n+    fuse(\"a;b;c;{d;e;f}\", \"{a,b,c,d,e,f}\");\n+    fuse(\"a;b; label: { if(q) break label; bar(); }\",\n+         \"label: { if(a,b,q) break label; bar(); }\");\n+    fuseSame(\"a;b;c;{var x;d;e;}\");\n+    fuseSame(\"a;b;c;label:{break label;d;e;}\");\n+  }\n+\n   public void testNoFuseIntoWhile() {\n     fuseSame(\"a;b;c;while(x){}\");\n   }", "timestamp": 1366761779, "metainfo": ""}