{"sha": "0a1685881280c60d286e9f5ac82128dbd9f46ad9", "log": "Fixes a bug whereby lines cut by the code printer b/w identifier chars could be incorrectly uncut, eg, instanceof\\nfoo -> instanceoffoo. This fix leaves a space where the cut was. Ideally we would only leave this space when absolutely necessary, though the cost of it is low.  R=acleung DELTA=11  (4 added, 1 deleted, 6 changed)   Revision created by MOE tool push_codebase. MOE_MIGRATION=4312   ", "commit": "\n--- a/src/com/google/javascript/jscomp/CodePrinter.java\n+++ b/src/com/google/javascript/jscomp/CodePrinter.java\n         append(\";\");\n         startNewLine();\n       } else if (prevCutPosition > 0) {\n-        // Shift the previous break to end of file.\n-        for (int i = prevCutPosition; i < code.length() - 1; i++) {\n-          code.setCharAt(i, code.charAt(i+1));\n-        }\n-        code.setLength(code.length() - 1);\n+        // Shift the previous break to end of file by replacing it with a\n+        // <space> and adding a new break at end of file. Adding the space\n+        // handles cases like instanceof\\nfoo. (it would be nice to avoid this)\n+        code.setCharAt(prevCutPosition, ' ');\n         lineStartPosition = prevLineStartPosition;\n         lineLength = code.length() - lineStartPosition;\n-        reportLineCut(lineIndex, prevCutPosition, false);\n+        reportLineCut(lineIndex, prevCutPosition + 1, false);\n         lineIndex--;\n         prevCutPosition = 0;\n         prevLineStartPosition = 0;\n--- a/test/com/google/javascript/jscomp/CodePrinterTest.java\n+++ b/test/com/google/javascript/jscomp/CodePrinterTest.java\n     assertLineBreakAtEndOfFile(\n         \"\\\"123456789012345678901234567890\\\";\\\"1234567890\\\"\",\n         \"\\\"123456789012345678901234567890\\\";\\n\\\"1234567890\\\"\",\n-        \"\\\"123456789012345678901234567890\\\";\\\"1234567890\\\";\\n\");\n+        \"\\\"123456789012345678901234567890\\\"; \\\"1234567890\\\";\\n\");\n+    assertLineBreakAtEndOfFile(\n+        \"var12345678901234567890123456 instanceof Object;\",\n+        \"var12345678901234567890123456 instanceof\\nObject\",\n+        \"var12345678901234567890123456 instanceof Object;\\n\");\n \n     // long final line, no previous break, add a break at end\n     assertLineBreakAtEndOfFile(", "timestamp": 1330644265, "metainfo": ""}