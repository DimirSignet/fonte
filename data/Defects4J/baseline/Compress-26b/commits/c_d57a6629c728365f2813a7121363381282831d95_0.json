{"sha": "d57a6629c728365f2813a7121363381282831d95", "log": "COMPRESS-232 improve readability of TarArchiveInputStream  ", "commit": "\n--- a/src/main/java/org/apache/commons/compress/archivers/tar/TarArchiveInputStream.java\n+++ b/src/main/java/org/apache/commons/compress/archivers/tar/TarArchiveInputStream.java\n \n         byte[] headerBuf = getRecord();\n \n-        if (hasHitEOF) {\n+        if (headerBuf == null) {\n+            /* hit EOF */\n             currEntry = null;\n             return null;\n         }\n      * over any remaining data in the current entry, if there\n      * is one, and place the input stream at the header of the\n      * next entry.\n-     * If there are no more entries in the archive, null will\n-     * be returned to indicate that the end of the archive has\n-     * been reached.\n+     *\n+     * <p>If there are no more entries in the archive, null will be\n+     * returned to indicate that the end of the archive has been\n+     * reached.  At the same time the {@code hasHitEOF} marker will be\n+     * set to true.</p>\n      *\n      * @return The next header in the archive, or null.\n      * @throws IOException on error\n      */\n     private byte[] getRecord() throws IOException {\n-        if (hasHitEOF) {\n-            return null;\n-        }\n-\n-        byte[] headerBuf = buffer.readRecord();\n-\n-        if (buffer.isEOFRecord(headerBuf)) {\n-            hasHitEOF = true;\n-            if (headerBuf != null) {\n+        byte[] headerBuf = null;\n+        if (!hasHitEOF) {\n+            headerBuf = buffer.readRecord();\n+            hasHitEOF = buffer.isEOFRecord(headerBuf);\n+            if (hasHitEOF && headerBuf != null) {\n                 buffer.tryToConsumeSecondEOFRecord();\n-            }\n-        }\n-\n-        return hasHitEOF ? null : headerBuf;\n+                headerBuf = null;\n+            }\n+        }\n+\n+        return headerBuf;\n     }\n \n     private void paxHeaders() throws IOException{\n             TarArchiveSparseEntry entry;\n             do {\n                 byte[] headerBuf = getRecord();\n-                if (hasHitEOF) {\n+                if (headerBuf == null) {\n                     currEntry = null;\n                     break;\n                 }", "timestamp": 1373293537, "metainfo": ""}