{"sha": "bcc697f34c60e556dc8cbc82e88ef2e877cb3b5f", "log": "Sebb pointed out that the implementation for LANG-507 was not thread safe. Rewriting to pass parameters in to the constructor, but doing so in an experimental way - comments very much desired on whether this makes for a nice API or not  ", "commit": "\n--- a/src/java/org/apache/commons/lang/text/translate/UnicodeUnescaper.java\n+++ b/src/java/org/apache/commons/lang/text/translate/UnicodeUnescaper.java\n import java.io.IOException;\n import java.io.Writer;\n \n+import java.util.EnumSet;\n+import java.util.Arrays;\n+\n /**\n  * Translates escaped unicode values of the form \\\\u+\\d\\d\\d\\d back to \n  * unicode.\n  */\n public class UnicodeUnescaper extends CharSequenceTranslator {\n \n-    private boolean escapingPlus = false;\n+    public static enum PARAM { escapePlus };\n \n-    public void setEscapingPlus(boolean b) {\n-        this.escapingPlus = b;\n+    private EnumSet<PARAM> params;\n+\n+    public UnicodeUnescaper(PARAM... params) {\n+        if(params.length > 0) {\n+            this.params = EnumSet.copyOf(Arrays.asList(params));\n+        }\n     }\n-    public boolean isEscapingPlus() {\n-        return this.escapingPlus;\n+\n+    public boolean isSet(PARAM p) { \n+        return (params == null) ? false : params.contains(p);\n     }\n \n     /**\n                 }\n \n                 // consume + symbol in \\\\u+0045\n-                if(isEscapingPlus()) {\n+                if(isSet(PARAM.escapePlus)) {\n                     if( (index + i < input.length()) && (input.charAt(index + i) == '+') ) {\n                         i++;\n                     }\n--- a/src/test/org/apache/commons/lang/text/translate/UnicodeUnescaperTest.java\n+++ b/src/test/org/apache/commons/lang/text/translate/UnicodeUnescaperTest.java\n             // expected\n         }\n \n-        uu.setEscapingPlus(true);\n+        uu = new UnicodeUnescaper(UnicodeUnescaper.PARAM.escapePlus);\n         assertEquals(\"Failed to unescape unicode characters with 'u+' notation\", \"G\", uu.translate(input));\n     }\n ", "timestamp": 1255896870, "metainfo": ""}