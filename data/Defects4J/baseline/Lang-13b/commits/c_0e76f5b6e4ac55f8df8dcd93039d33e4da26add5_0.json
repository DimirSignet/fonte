{"sha": "0e76f5b6e4ac55f8df8dcd93039d33e4da26add5", "log": "[LANG-716] swapCase and *capitalize speedups.  ", "commit": "\n--- a/src/main/java/org/apache/commons/lang3/StringUtils.java\n+++ b/src/main/java/org/apache/commons/lang3/StringUtils.java\n      * @return the changed String, {@code null} if null String input\n      */\n     public static String swapCase(String str) {\n-        int strLen;\n-        if (str == null || (strLen = str.length()) == 0) {\n+        if (str == null || str.length() == 0) {\n             return str;\n         }\n-        StringBuilder buffer = new StringBuilder(strLen);\n-\n-        char ch = 0;\n-        for (int i = 0; i < strLen; i++) {\n-            ch = str.charAt(i);\n+\n+        char[] buffer = str.toCharArray();\n+\n+        for (int i = 0; i < buffer.length; i++) {\n+            char ch = buffer[i];\n             if (Character.isUpperCase(ch)) {\n-                ch = Character.toLowerCase(ch);\n+                buffer[i] = Character.toLowerCase(ch);\n             } else if (Character.isTitleCase(ch)) {\n-                ch = Character.toLowerCase(ch);\n+                buffer[i] = Character.toLowerCase(ch);\n             } else if (Character.isLowerCase(ch)) {\n-                ch = Character.toUpperCase(ch);\n-            }\n-            buffer.append(ch);\n-        }\n-        return buffer.toString();\n+                buffer[i] = Character.toUpperCase(ch);\n+            }\n+        }\n+        return new String(buffer);\n     }\n \n     // Count matches\n--- a/src/main/java/org/apache/commons/lang3/text/WordUtils.java\n+++ b/src/main/java/org/apache/commons/lang3/text/WordUtils.java\n         if (str == null || str.length() == 0 || delimLen == 0) {\n             return str;\n         }\n-        int strLen = str.length();\n-        StringBuilder buffer = new StringBuilder(strLen);\n+        char[] buffer = str.toCharArray();\n         boolean capitalizeNext = true;\n-        for (int i = 0; i < strLen; i++) {\n-            char ch = str.charAt(i);\n-\n+        for (int i = 0; i < buffer.length; i++) {\n+            char ch = buffer[i];\n             if (isDelimiter(ch, delimiters)) {\n-                buffer.append(ch);\n                 capitalizeNext = true;\n             } else if (capitalizeNext) {\n-                buffer.append(Character.toTitleCase(ch));\n+                buffer[i] = Character.toTitleCase(ch);\n                 capitalizeNext = false;\n-            } else {\n-                buffer.append(ch);\n-            }\n-        }\n-        return buffer.toString();\n+            }\n+        }\n+        return new String(buffer);\n     }\n \n     //-----------------------------------------------------------------------\n         if (str == null || str.length() == 0 || delimLen == 0) {\n             return str;\n         }\n-        int strLen = str.length();\n-        StringBuilder buffer = new StringBuilder(strLen);\n+        char[] buffer = str.toCharArray();\n         boolean uncapitalizeNext = true;\n-        for (int i = 0; i < strLen; i++) {\n-            char ch = str.charAt(i);\n-\n+        for (int i = 0; i < buffer.length; i++) {\n+            char ch = buffer[i];\n             if (isDelimiter(ch, delimiters)) {\n-                buffer.append(ch);\n                 uncapitalizeNext = true;\n             } else if (uncapitalizeNext) {\n-                buffer.append(Character.toLowerCase(ch));\n+                buffer[i] = Character.toLowerCase(ch);\n                 uncapitalizeNext = false;\n-            } else {\n-                buffer.append(ch);\n-            }\n-        }\n-        return buffer.toString();\n+            }\n+        }\n+        return new String(buffer);\n     }\n \n     //-----------------------------------------------------------------------\n      * @return the changed String, <code>null</code> if null String input\n      */\n     public static String swapCase(String str) {\n-        int strLen;\n-        if (str == null || (strLen = str.length()) == 0) {\n+        if (str == null || str.length() == 0) {\n             return str;\n         }\n-        StringBuilder buffer = new StringBuilder(strLen);\n+        char[] buffer = str.toCharArray();\n \n         boolean whitespace = true;\n-        char ch = 0;\n-        char tmp = 0;\n-\n-        for (int i = 0; i < strLen; i++) {\n-            ch = str.charAt(i);\n+\n+        for (int i = 0; i < buffer.length; i++) {\n+            char ch = buffer[i];\n             if (Character.isUpperCase(ch)) {\n-                tmp = Character.toLowerCase(ch);\n+                buffer[i] = Character.toLowerCase(ch);\n+                whitespace = false;\n             } else if (Character.isTitleCase(ch)) {\n-                tmp = Character.toLowerCase(ch);\n+                buffer[i] = Character.toLowerCase(ch);\n+                whitespace = false;\n             } else if (Character.isLowerCase(ch)) {\n                 if (whitespace) {\n-                    tmp = Character.toTitleCase(ch);\n+                    buffer[i] = Character.toTitleCase(ch);\n+                    whitespace = false;\n                 } else {\n-                    tmp = Character.toUpperCase(ch);\n+                    buffer[i] = Character.toUpperCase(ch);\n                 }\n             } else {\n-                tmp = ch;\n-            }\n-            buffer.append(tmp);\n-            whitespace = Character.isWhitespace(ch);\n-        }\n-        return buffer.toString();\n+                whitespace = Character.isWhitespace(ch);\n+            }\n+        }\n+        return new String(buffer);\n     }\n \n     //-----------------------------------------------------------------------", "timestamp": 1310320916, "metainfo": ""}