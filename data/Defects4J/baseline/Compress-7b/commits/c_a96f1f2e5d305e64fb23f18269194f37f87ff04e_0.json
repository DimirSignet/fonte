{"sha": "a96f1f2e5d305e64fb23f18269194f37f87ff04e", "log": "use NIO to decode names as well  ", "commit": "\n--- a/src/main/java/org/apache/commons/compress/archivers/zip/ZipEncodingHelper.java\n+++ b/src/main/java/org/apache/commons/compress/archivers/zip/ZipEncodingHelper.java\n \n         return enc.canEncode(name);\n     }\n+\n+    /**\n+     * Decode a filename or a comment from a byte array.\n+     * \n+     * @param name The filename or comment.\n+     * @param encoding A valid encoding name. The standard zip\n+     *                 encoding is <code>\"CP437\"</code>,\n+     *                 <code>\"UTF-8\"</code> is supported in ZIP file\n+     *                 version <code>6.3</code> or later.\n+     */\n+    static final String decodeName(byte[] name, String encoding) {\n+        Charset cs = Charset.forName(encoding);\n+        return cs.decode(ByteBuffer.wrap(name)).toString();\n+    }\n }\n--- a/src/main/java/org/apache/commons/compress/archivers/zip/ZipFile.java\n+++ b/src/main/java/org/apache/commons/compress/archivers/zip/ZipFile.java\n             return new String(bytes);\n         } else {\n             try {\n-                return new String(bytes, enc);\n-            } catch (UnsupportedEncodingException uee) {\n-                throw new ZipException(uee.getMessage());\n+                return ZipEncodingHelper.decodeName(bytes, encoding);\n+            } catch (java.nio.charset.UnsupportedCharsetException ex) {\n+                // Java 1.4's NIO doesn't recognize a few names that\n+                // String.getBytes does\n+                try {\n+                    return new String(bytes, enc);\n+                } catch (UnsupportedEncodingException uee) {\n+                    throw new ZipException(uee.getMessage());\n+                }\n             }\n         }\n     }", "timestamp": 1235379719, "metainfo": ""}