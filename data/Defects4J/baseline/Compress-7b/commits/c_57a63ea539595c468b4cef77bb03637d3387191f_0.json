{"sha": "57a63ea539595c468b4cef77bb03637d3387191f", "log": "Add some tests with a single file archive  ", "commit": "\n--- a/src/test/java/org/apache/commons/compress/changes/ChangeSetTestCase.java\n+++ b/src/test/java/org/apache/commons/compress/changes/ChangeSetTestCase.java\n \n         this.checkArchiveContent(result, archiveList);\n     }\n+\n+    /**\n+     * Check can delete and add a file to an archive with a single file\n+     * \n+     * @throws Exception\n+     */\n+    public void testDeleteAddToOneFileArchive() throws Exception {\n+        File input = this.createSingleEntryArchive(\"zip\");\n+\n+        ArchiveOutputStream out = null;\n+        ArchiveInputStream ais = null;\n+        InputStream is = null;\n+        File result = File.createTempFile(\"test\", \".zip\");\n+        result.deleteOnExit();\n+        ChangeSet changes = new ChangeSet();\n+        try {\n+\n+            is = new FileInputStream(input);\n+            ais = factory.createArchiveInputStream(\"zip\", is);\n+\n+            out = factory.createArchiveOutputStream(\"zip\",\n+                    new FileOutputStream(result));\n+            changes.delete(\"testdata\");\n+            archiveListDelete(\"testdata\");\n+            \n+            ArchiveEntry entry = new ZipArchiveEntry(\"bla/test.txt\");\n+            changes.add(entry, new FileInputStream(getFile(\"test.txt\")));\n+            archiveList.add(\"bla/test.txt\");\n+            \n+            changes.perform(ais, out);\n+            is.close();\n+\n+        } finally {\n+            if (out != null) {\n+                out.close();\n+            }\n+            if (ais != null) {\n+                ais.close(); // will close is \n+            } else if (is != null){\n+                is.close();\n+            }\n+        }\n+\n+        this.checkArchiveContent(result, archiveList);\n+    }\n+\n+    /**\n+     * Check can add and delete a file to an archive with a single file\n+     * \n+     * @throws Exception\n+     */\n+    public void testAddDeleteToOneFileArchive() throws Exception {\n+        File input = this.createSingleEntryArchive(\"zip\");\n+\n+        ArchiveOutputStream out = null;\n+        ArchiveInputStream ais = null;\n+        InputStream is = null;\n+        File result = File.createTempFile(\"test\", \".zip\");\n+        result.deleteOnExit();\n+        ChangeSet changes = new ChangeSet();\n+        try {\n+\n+            is = new FileInputStream(input);\n+            ais = factory.createArchiveInputStream(\"zip\", is);\n+\n+            out = factory.createArchiveOutputStream(\"zip\",\n+                    new FileOutputStream(result));\n+            ArchiveEntry entry = new ZipArchiveEntry(\"bla/test.txt\");\n+            changes.add(entry, new FileInputStream(getFile(\"test.txt\")));\n+            archiveList.add(\"bla/test.txt\");\n+\n+            changes.delete(\"testdata\");\n+            archiveListDelete(\"testdata\");\n+            \n+            changes.perform(ais, out);\n+            is.close();\n+\n+        } finally {\n+            if (out != null) {\n+                out.close();\n+            }\n+            if (ais != null) {\n+                ais.close(); // will close is \n+            } else if (is != null){\n+                is.close();\n+            }\n+        }\n+\n+        this.checkArchiveContent(result, archiveList);\n+    }\n }", "timestamp": 1238375882, "metainfo": ""}