{"sha": "8a14f3ead37bd2e46f650a2f15ffef868772bb5a", "log": "Allow proper inlining of aliases of classes with \"goog.addSingletonGetter\" calls. ------------- Created by MOE: http://code.google.com/p/moe-java MOE_MIGRATED_REVID=51558252", "commit": "\n--- a/src/com/google/javascript/jscomp/GlobalNamespace.java\n+++ b/src/com/google/javascript/jscomp/GlobalNamespace.java\n     }\n \n     private boolean isClassDefiningCall(Node callNode) {\n+      CodingConvention convention = compiler.getCodingConvention();\n+      // Look for goog.inherits, goog.mixin\n       SubclassRelationship classes =\n-          compiler.getCodingConvention().getClassesDefinedByCall(callNode);\n-      return classes != null;\n+          convention.getClassesDefinedByCall(callNode);\n+      if (classes != null) {\n+        return true;\n+      }\n+\n+      // Look for calls to goog.addSingletonGetter calls.\n+      String className = convention.getSingletonGetterClassName(callNode);\n+      if (className != null) {\n+        return true;\n+      }\n+      return false;\n     }\n \n     /**\n--- a/test/com/google/javascript/jscomp/CollapsePropertiesTest.java\n+++ b/test/com/google/javascript/jscomp/CollapsePropertiesTest.java\n         \"}\");\n   }\n \n+  public void testCollapsePropertiesOfClass2() {\n+    test(\n+        \"var goog = goog || {};\\n\" +\n+        \"goog.addSingletonGetter = function(cls) {};\\n\" +\n+        \"\\n\" +\n+        \"var a = {};\\n\" +\n+        \"\\n\" +\n+        \"/** @constructor */\\n\" +\n+        \"a.b = function() {};\\n\" +\n+        \"goog.addSingletonGetter(a.b);\\n\" +\n+        \"a.b.prototype.get = function(key) {};\\n\" +\n+        \"\\n\" +\n+        \"/** @constructor */\\n\" +\n+        \"a.b.c = function() {};\\n\" +\n+        \"a.b.c.XXX = new a.b.c();\\n\" +\n+        \"\\n\" +\n+        \"function f() {\\n\" +\n+        \"  var x = a.b.getInstance();\\n\" +\n+        \"  var Key = a.b.c;\\n\" +\n+        \"  x.get(Key.XXX);\\n\" +\n+        \"}\",\n+\n+        \"var goog = goog || {};\\n\" +\n+        \"var goog$addSingletonGetter = function(cls) {};\\n\" +\n+        \"var a$b = function() {};\\n\" +\n+        \"goog$addSingletonGetter(a$b);\\n\" +\n+        \"a$b.prototype.get = function(key) {};\\n\" +\n+        \"var a$b$c = function() {};\\n\" +\n+        \"var a$b$c$XXX = new a$b$c();\\n\" +\n+        \"\\n\" +\n+        \"function f() {\\n\" +\n+        \"  var x = a$b.getInstance();\\n\" +\n+        \"  var Key = null;\\n\" +\n+        \"  x.get(a$b$c$XXX);\\n\" +\n+        \"}\");\n+  }\n+\n   public void testGlobalCatch() throws Exception {\n     testSame(\n         \"try {\" +", "timestamp": 1377822226, "metainfo": ""}