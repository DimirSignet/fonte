{"sha": "c7c4931b47cab8e4cf66d92647b1970dcd022fb9", "log": "Makes NodeUtil.newQualifiedNameNode to correctly process names that start with \"this\" keyword. Adds tests to NodeUtil.newQualifiedNameNode. ------------- Created by MOE: http://code.google.com/p/moe-java MOE_MIGRATED_REVID=42928773", "commit": "\n--- a/src/com/google/javascript/jscomp/NodeUtil.java\n+++ b/src/com/google/javascript/jscomp/NodeUtil.java\n     if (endPos == -1) {\n       return newName(convention, name);\n     }\n-    Node node = newName(convention, name.substring(0, endPos));\n+    Node node;\n+    String nodeName = name.substring(0, endPos);\n+    if (\"this\".equals(nodeName)) {\n+      node = IR.thisNode();\n+    } else {\n+      node = newName(convention, nodeName);\n+    }\n     int startPos;\n     do {\n       startPos = endPos + 1;\n--- a/test/com/google/javascript/jscomp/NodeUtilTest.java\n+++ b/test/com/google/javascript/jscomp/NodeUtilTest.java\n     assertEquals(false, executedOnceTestCase(\"if (1) { try {} finally {x} }\"));\n   }\n \n+  public void testNewQualifiedNameNode1() {\n+    Node actual = NodeUtil.newQualifiedNameNode(\n+        new GoogleCodingConvention(), \"ns.prop\");\n+    Node expected = IR.getprop(\n+        IR.name(\"ns\"),\n+        IR.string(\"prop\"));\n+    assertNodeTreesEqual(expected, actual);\n+  }\n+\n+  public void testNewQualifiedNameNode2() {\n+    Node actual = NodeUtil.newQualifiedNameNode(\n+        new GoogleCodingConvention(), \"this.prop\");\n+    Node expected = IR.getprop(\n+        IR.thisNode(),\n+        IR.string(\"prop\"));\n+    assertNodeTreesEqual(expected, actual);\n+  }\n+\n   private boolean executedOnceTestCase(String code) {\n     Node ast = parse(code);\n     Node nameNode = getNameNode(ast, \"x\");\n   private String getFunctionLValue(String js) {\n     Node lVal = NodeUtil.getBestLValue(getFunctionNode(js));\n     return lVal == null ? null : lVal.getString();\n+  }\n+\n+  private void assertNodeTreesEqual(\n+      Node expected, Node actual) {\n+    String error = expected.checkTreeEquals(actual);\n+    assertNull(error, error);\n   }\n \n   static void testFunctionName(String js, String expected) {", "timestamp": 1361568679, "metainfo": ""}