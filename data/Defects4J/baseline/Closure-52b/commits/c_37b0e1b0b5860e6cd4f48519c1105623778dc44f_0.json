{"sha": "37b0e1b0b5860e6cd4f48519c1105623778dc44f", "log": "Column-indicating caret can be in the end of a line.  Fixes issue 487.  R=acleung DELTA=21  (20 added, 0 deleted, 1 changed)   Revision created by MOE tool push_codebase. MOE_MIGRATION=2418   ", "commit": "\n--- a/src/com/google/javascript/jscomp/LightweightMessageFormatter.java\n+++ b/src/com/google/javascript/jscomp/LightweightMessageFormatter.java\n       int charno = error.getCharno();\n \n       // padding equal to the excerpt and arrow at the end\n+      // charno == sourceExpert.length() means something is missing\n+      // at the end of the line\n       if (excerpt.equals(LINE)\n-          && 0 <= charno && charno < sourceExcerpt.length()) {\n+          && 0 <= charno && charno <= sourceExcerpt.length()) {\n         for (int i = 0; i < charno; i++) {\n           char c = sourceExcerpt.charAt(i);\n           if (Character.isWhitespace(c)) {\n--- a/test/com/google/javascript/jscomp/LightweightMessageFormatterTest.java\n+++ b/test/com/google/javascript/jscomp/LightweightMessageFormatterTest.java\n         \"\\t\\t    ^\\n\", formatter.formatError(error));\n   }\n \n+  public void testFormatErrorSpaceEndOfLine1() throws Exception {\n+    JSError error = JSError.make(\"javascript/complex.js\",\n+        1, 10, FOO_TYPE);\n+    LightweightMessageFormatter formatter = formatter(\"assert (1;\");\n+    assertEquals(\"javascript/complex.js:1: ERROR - error description here\\n\" +\n+        \"assert (1;\\n\" +\n+        \"          ^\\n\", formatter.formatError(error));\n+  }\n+\n+  public void testFormatErrorSpaceEndOfLine2() throws Exception {\n+    JSError error = JSError.make(\"javascript/complex.js\",\n+        6, 7, FOO_TYPE);\n+    LightweightMessageFormatter formatter = formatter(\"if (foo\");\n+    assertEquals(\"javascript/complex.js:6: ERROR - error description here\\n\" +\n+        \"if (foo\\n\" +\n+        \"       ^\\n\", formatter.formatError(error));\n+  }\n+\n   private LightweightMessageFormatter formatter(String string) {\n     return new LightweightMessageFormatter(source(string));\n   }", "timestamp": 1309207620, "metainfo": ""}