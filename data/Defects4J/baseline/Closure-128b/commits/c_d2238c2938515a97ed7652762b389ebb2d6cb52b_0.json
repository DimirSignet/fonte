{"sha": "d2238c2938515a97ed7652762b389ebb2d6cb52b", "log": "don't warn about module violations at sanity check time We already check this upstream, and emitting these doesn't make sense unless we plan to throw an illegal state exception and stop compilation (because the symbols are too obfuscated to be useful)  R=johnlenz DELTA=11  (1 added, 2 deleted, 8 changed)   Revision created by MOE tool push_codebase. MOE_MIGRATION=4159   ", "commit": "\n--- a/src/com/google/javascript/jscomp/VarCheck.java\n+++ b/src/com/google/javascript/jscomp/VarCheck.java\n     JSModule currModule = currInput.getModule();\n     JSModule varModule = varInput.getModule();\n     JSModuleGraph moduleGraph = compiler.getModuleGraph();\n-    if (varModule != currModule && varModule != null && currModule != null) {\n+    if (!sanityCheck &&\n+        varModule != currModule && varModule != null && currModule != null) {\n       if (moduleGraph.dependsOn(currModule, varModule)) {\n         // The module dependency was properly declared.\n       } else {\n-        if (!sanityCheck && scope.isGlobal()) {\n+        if (scope.isGlobal()) {\n           if (moduleGraph.dependsOn(varModule, currModule)) {\n             // The variable reference violates a declared module dependency.\n             t.report(n, VIOLATED_MODULE_DEP_ERROR,\n--- a/test/com/google/javascript/jscomp/VarCheckTest.java\n+++ b/test/com/google/javascript/jscomp/VarCheckTest.java\n                          null);\n   }\n \n-  public void testMissingModuleDependencySkipNonStrictPromoted() {\n+  public void testMissingModuleDependencySkipNonStrictNotPromoted() {\n     sanityCheck = true;\n     strictModuleDepErrorLevel = CheckLevel.ERROR;\n-    testIndependentModules(\"var x = 10;\", \"var y = x++;\",\n-        VarCheck.STRICT_MODULE_DEP_ERROR, null);\n-  }\n-\n-  public void testViolatedModuleDependencyNonStrictPromoted() {\n+    testIndependentModules(\"var x = 10;\", \"var y = x++;\", null, null);\n+  }\n+\n+  public void testViolatedModuleDependencyNonStrictNotPromoted() {\n     sanityCheck = true;\n     strictModuleDepErrorLevel = CheckLevel.ERROR;\n-    testDependentModules(\"var y = x++;\", \"var x = 10;\",\n-        VarCheck.STRICT_MODULE_DEP_ERROR);\n+    testDependentModules(\"var y = x++;\", \"var x = 10;\", null);\n   }\n \n   public void testDependentStrictModuleDependencyCheck() {", "timestamp": 1328042689, "metainfo": ""}