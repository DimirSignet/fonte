{"sha": "43ef4fb52b64c65ebad5018ab8dff91b48f6033c", "log": "Add some language mode tests.  R=acleung DELTA=24  (23 added, 0 deleted, 1 changed)   Revision created by MOE tool push_codebase. MOE_MIGRATION=1961   ", "commit": "\n--- a/test/com/google/javascript/jscomp/CommandLineRunnerTest.java\n+++ b/test/com/google/javascript/jscomp/CommandLineRunnerTest.java\n \n import com.google.common.base.Function;\n import com.google.common.base.Joiner;\n+import com.google.common.base.Preconditions;\n import com.google.common.base.Supplier;\n import com.google.common.base.Suppliers;\n import com.google.common.collect.ImmutableList;\n import com.google.common.collect.Lists;\n+import com.google.javascript.jscomp.CompilerOptions.LanguageMode;\n import com.google.javascript.rhino.Node;\n \n import junit.framework.TestCase;\n     assertEquals(2, compiler.getErrors().length);\n   }\n \n+  public void testES3ByDefault() {\n+    test(\"var x = f.function\", RhinoErrorReporter.PARSE_ERROR);\n+  }\n+\n+  public void testES5() {\n+    args.add(\"--language_in=ECMASCRIPT5\");\n+    test(\"var x = f.function\", \"var x = f.function\");\n+    test(\"var let\", \"var let\");\n+  }\n+\n+  public void testES5Strict() {\n+    args.add(\"--language_in=ECMASCRIPT5_STRICT\");\n+    test(\"var x = f.function\", \"'use strict';var x = f.function\");\n+    test(\"var let\", RhinoErrorReporter.PARSE_ERROR);\n+  }\n+\n   /* Helper functions */\n \n   private void testSame(String original) {\n     for (int i = 0; i < original.length; i++) {\n       inputs.add(JSSourceFile.fromCode(\"input\" + i, original[i]));\n     }\n-    compiler.init(externs, inputs, new CompilerOptions());\n+    CompilerOptions options = new CompilerOptions();\n+    // ECMASCRIPT5 is the most forgiving.\n+    options.setLanguageIn(LanguageMode.ECMASCRIPT5);\n+    compiler.init(externs, inputs, options);\n     Node all = compiler.parseInputs();\n+    Preconditions.checkState(compiler.getErrorCount() == 0);\n+    Preconditions.checkNotNull(all);\n     Node n = all.getLastChild();\n     return n;\n   }", "timestamp": 1305848511, "metainfo": ""}