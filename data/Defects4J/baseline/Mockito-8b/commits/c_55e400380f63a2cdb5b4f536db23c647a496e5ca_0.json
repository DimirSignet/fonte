{"sha": "55e400380f63a2cdb5b4f536db23c647a496e5ca", "log": "more and more refactorings  --HG-- extra : convert_revision : svn%3Aaa2aecf3-ea3e-0410-9d70-716747e7c967/trunk%40159", "commit": "\n--- a/src/org/mockito/internal/MockitoState.java\n+++ b/src/org/mockito/internal/MockitoState.java\n-/*\n- * Copyright (c) 2007 Mockito contributors \n- * This program is made available under the terms of the MIT License.\n- */\n package org.mockito.internal;\n \n-import org.mockito.exceptions.Exceptions;\n+@SuppressWarnings(\"unchecked\")\n+public interface MockitoState {\n \n-@SuppressWarnings(\"unchecked\")\n-public class MockitoState {\n+    void reportControlForStubbing(MockControl mockControl);\n+\n+    MockitoExpectation pullControlToBeStubbed();\n+\n+    void verifyingStarted(VerifyingMode verify);\n+\n+    VerifyingMode pullVerifyingMode();\n+\n+    void stubbingStarted();\n+\n+    void stubbingCompleted();\n     \n-    private static ThreadLocal<MockitoState> INSTANCE = new ThreadLocal<MockitoState>();\n-        \n-    private MockControl lastControl;\n-    private VerifyingMode verifyingMode;\n-    private int invocationSequenceNumber = 1;\n-    private boolean stubbingInProgress = false;\n+    int nextSequenceNumber();\n \n-    public static MockitoState instance() {\n-        if (INSTANCE.get() == null) {\n-            INSTANCE.set(new MockitoState());\n-        }\n-        return INSTANCE.get();\n-    }\n-    \n-    public void reportControlForStubbing(MockControl mockControl) {\n-        lastControl = mockControl;\n-    }\n+    void validateState();\n \n-    public MockitoExpectation pullControlToBeStubbed() {\n-        MockControl temp = lastControl;\n-        lastControl = null;\n-        return temp;\n-    }\n-    \n-    public void verifyingStarted(VerifyingMode verify) {\n-        validateState();\n-        verifyingMode = verify;\n-    }\n-\n-    public VerifyingMode pullVerifyingMode() {\n-        VerifyingMode temp = verifyingMode;\n-        verifyingMode = null;\n-        return temp;\n-    }\n-\n-    public int nextSequenceNumber() {\n-        return invocationSequenceNumber++;\n-    }\n-\n-    public void stubbingStarted() {\n-        validateState();\n-        stubbingInProgress = true;\n-    }\n-\n-    public void validateState() {\n-        if (verifyingMode != null) {\n-            verifyingMode = null;\n-            Exceptions.unfinishedVerificationException();\n-        }\n-        \n-        if (stubbingInProgress) {\n-            stubbingInProgress = false;\n-            Exceptions.unfinishedStubbing();\n-        }\n-    }\n-\n-    public void stubbingCompleted() {\n-        stubbingInProgress = false;\n-    }\n-    \n-    public String toString() {\n-        return  \"lastControl: \" + lastControl + \n-        \", verifyingMode: \" + verifyingMode +\n-        \", invocationSequenceNumber: \" + invocationSequenceNumber +\n-        \", stubbingInProgress: \" + stubbingInProgress;\n-    }\n-\n-    void reset() {\n-        stubbingInProgress = false;\n-        verifyingMode = null;\n-        invocationSequenceNumber = 1;\n-    }\n-}\n+    void reset();\n+}", "timestamp": 1197331135, "metainfo": ""}