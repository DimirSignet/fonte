{"sha": "51c5fcd126afeb3e2b3eb8e9fa91a76339a8277f", "log": "Further refactoring of exception messages - following the new patterns of storing and presenting locations of errors / verification failures  --HG-- extra : convert_revision : svn%3Aaa2aecf3-ea3e-0410-9d70-716747e7c967/trunk%401293", "commit": "\n--- a/src/org/mockito/exceptions/Reporter.java\n+++ b/src/org/mockito/exceptions/Reporter.java\n     }\n     \n     public void neverWantedButInvoked(PrintableInvocation wanted, HasStackTrace firstUndesired) {\n-        UndesiredInvocation cause = createUndesiredInvocationCause(firstUndesired);\n-\n         throw new NeverWantedButInvoked(join(\n                 wanted.toString(),\n-                \"Never wanted but invoked!\"\n-        ), cause);\n+                \"Never wanted here:\",\n+                \"-> at \" + new Location(),\n+                \"But invoked here:\",\n+                \"-> at \" + firstUndesired.getStackTrace()[0],\n+                \"\"\n+        ));\n     }    \n     \n     public void tooManyActualInvocationsInOrder(int wantedCount, int actualCount, PrintableInvocation wanted, HasStackTrace firstUndesired) {\n                 \"Verification in order failure:\" + message\n                 ));\n     }\n-\n-    private UndesiredInvocation createUndesiredInvocationCause(HasStackTrace firstUndesired) {\n-        UndesiredInvocation cause = new UndesiredInvocation(join(\"Undesired invocation:\"));\n-        cause.setStackTrace(firstUndesired.getStackTrace());\n-        return cause;\n-    }    \n \n     private String createTooLittleInvocationsMessage(int wantedCount, int actualCount, PrintableInvocation wanted,\n             HasStackTrace lastActualStackTrace) {\n--- a/src/org/mockito/exceptions/verification/NeverWantedButInvoked.java\n+++ b/src/org/mockito/exceptions/verification/NeverWantedButInvoked.java\n \n     private static final long serialVersionUID = 1L;\n \n-    public NeverWantedButInvoked(String message, Throwable cause) {\n-        super(message, cause);\n+    public NeverWantedButInvoked(String message) {\n+        super(message);\n     }\n }\n--- a/test/org/mockitousage/stacktrace/PointingStackTraceToActualInvocationTest.java\n+++ b/test/org/mockitousage/stacktrace/PointingStackTraceToActualInvocationTest.java\n package org.mockitousage.stacktrace;\n \n import static org.mockito.Mockito.*;\n-import static org.mockitoutil.ExtraMatchers.*;\n \n import org.junit.Before;\n import org.junit.Test;\n             verify(mock, times(0)).simpleMethod(1);\n             fail();\n         } catch (NeverWantedButInvoked e) {\n-            assertThat(e.getCause(), hasFirstMethodInStackTrace(\"first\"));\n+            assertContains(\"first(\", e.getMessage());\n         }\n     }   \n }\n--- a/test/org/mockitousage/verification/DescriptiveMessagesWhenVerificationFailsTest.java\n+++ b/test/org/mockitousage/verification/DescriptiveMessagesWhenVerificationFailsTest.java\n             verify(mock, never()).simpleMethod(1);\n             fail();\n         } catch (NeverWantedButInvoked e) {\n-            assertThat(e, messageContains(\"Never wanted but invoked!\"));\n-            assertThat(e, causeMessageContains(\"Undesired invocation\"));\n+            assertThat(e, messageContains(\"Never wanted here:\"));\n+            assertThat(e, messageContains(\"But invoked here:\"));\n         }\n     }\n     \n--- a/test/org/mockitousage/verification/ExactNumberOfTimesVerificationTest.java\n+++ b/test/org/mockitousage/verification/ExactNumberOfTimesVerificationTest.java\n             verify(mock, times(0)).clear();\n             fail();\n         } catch (NeverWantedButInvoked e) {\n-            assertThat(e, messageContains(\"Never wanted but invoked!\"));\n+            assertThat(e, messageContains(\"Never wanted here\"));\n         }\n     }\n ", "timestamp": 1238765438, "metainfo": ""}