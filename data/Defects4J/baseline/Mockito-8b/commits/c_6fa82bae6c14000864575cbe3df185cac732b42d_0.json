{"sha": "6fa82bae6c14000864575cbe3df185cac732b42d", "log": "Growing the release plugin  Refactoring and tidy up", "commit": "\n--- a/buildSrc/src/main/groovy/org/mockito/release/steps/DefaultReleaseStep.java\n+++ b/buildSrc/src/main/groovy/org/mockito/release/steps/DefaultReleaseStep.java\n     return description;\n   }\n \n+  public void performRollback() {\n+    if (rollback != null) {\n+      rollback.perform();\n+    } else if (cleanup != null) {\n+      cleanup.perform();\n+    } else {\n+      System.out.println(\"No rollback or cleanup operation found for step '\" + description + \"'\");\n+    }\n+  }\n+\n   public void rollback(Closure closure) {\n     rollback = Operations.toOperation(closure);\n   }\n \n   public void cleanup(Closure closure) {\n     this.cleanup = Operations.toOperation(closure);\n-  }\n-\n-  public Operation getRollback() {\n-    return rollback;\n   }\n \n   public void perform() {\n--- a/buildSrc/src/main/groovy/org/mockito/release/steps/DefaultReleaseSteps.java\n+++ b/buildSrc/src/main/groovy/org/mockito/release/steps/DefaultReleaseSteps.java\n         LinkedList<ReleaseStep> targets = new LinkedList<ReleaseStep>(attempted);\n         while(!targets.isEmpty()) {\n             ReleaseStep s = targets.removeLast();\n-            Operation r = s.getRollback();\n-            Operation c = s.getCleanup();\n-            if (r != null) {\n-              System.out.println(\"Rolling back step \" + (targets.size() + 1) + \" (\" + s.getDescription() + \")\");\n-              r.perform();\n-            } else if (c != null) {\n-              System.out.println(\"Cleaning up after step \" + (targets.size() + 1) + \" (\" + s.getDescription() + \")\");\n-              c.perform();\n-            } else {\n-              System.out.println(\"No rollback for step \" + (targets.size() + 1) + \" (\" + s.getDescription() + \")\");\n-            }\n+            //TODO SF push this message down\n+            System.out.println(\"Attempting to roll back step \" + (targets.size() + 1) + \" (\" + s.getDescription() + \")\");\n+            s.performRollback();\n         }\n     }\n }\n--- a/buildSrc/src/main/groovy/org/mockito/release/steps/ReleaseStep.java\n+++ b/buildSrc/src/main/groovy/org/mockito/release/steps/ReleaseStep.java\n \n   String getDescription();\n \n-  /**\n-   * may return null. TODO: I don't like this\n-   */\n-  Operation getRollback();\n+  void performRollback();\n \n   /**\n    * may return null. TODO: I don't like this", "timestamp": 1419889144, "metainfo": ""}