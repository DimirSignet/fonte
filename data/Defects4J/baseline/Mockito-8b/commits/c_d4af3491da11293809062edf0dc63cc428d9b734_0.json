{"sha": "d4af3491da11293809062edf0dc63cc428d9b734", "log": "Finished implementing reset() removed some dead code  --HG-- extra : convert_revision : svn%3Aaa2aecf3-ea3e-0410-9d70-716747e7c967/trunk%401329", "commit": "\n--- a/src/org/mockito/internal/MockHandler.java\n+++ b/src/org/mockito/internal/MockHandler.java\n         mockitoStubber.setAnswersForStubbing(answers);\n     }\n \n-    public boolean hasName() {\n-        return false;\n+    public ReturnValues getReturnValues() {\n+        return returnValues;\n     }\n }\n--- a/src/org/mockito/internal/MockitoCore.java\n+++ b/src/org/mockito/internal/MockitoCore.java\n import java.util.Arrays;\n \n import org.mockito.InOrder;\n-import org.mockito.Mockito;\n import org.mockito.ReturnValues;\n import org.mockito.exceptions.Reporter;\n import org.mockito.exceptions.misusing.NotAMockException;\n         MOCKING_PROGRESS.validateState();\n         MOCKING_PROGRESS.reset();\n         MOCKING_PROGRESS.resetOngoingStubbing();\n-        //TODO Perhaps we should maintain previous ReturnValues?\n         \n         for (T m : mocks) {\n-            MockUtil.resetMock(m, MOCKING_PROGRESS, Mockito.RETURNS_DEFAULTS);\n+            MockUtil.resetMock(m, MOCKING_PROGRESS);\n         }\n     }\n     \n--- a/src/org/mockito/internal/util/MockUtil.java\n+++ b/src/org/mockito/internal/util/MockUtil.java\n         return mock;\n     }\n \n-    public static <T> void resetMock(T mock, MockingProgress progress, ReturnValues returnValues) {\n+    public static <T> void resetMock(T mock, MockingProgress progress) {\n         MockHandler<T> oldMockHandler = (MockHandler<T>) getMockHandler(mock);\n-        MockHandler<T> newMockHandler = new MockHandler<T>(oldMockHandler.getMockName(), progress, new MatchersBinder(), returnValues);\n+        MockHandler<T> newMockHandler = new MockHandler<T>(oldMockHandler.getMockName(), progress, new MatchersBinder(), oldMockHandler.getReturnValues());\n         MethodInterceptorFilter<MockHandler<T>> newFilter = new MethodInterceptorFilter<MockHandler<T>>(Object.class, newMockHandler);\n         newFilter.setInstance(mock);\n         ((Factory) mock).setCallback(0, newFilter);\n--- a/test/org/mockitousage/reset/ResetTest.java\n+++ b/test/org/mockitousage/reset/ResetTest.java\n             fail();\n         } catch (UnfinishedVerificationException e) {}\n     }\n+    \n+    @Test\n+    public void shouldMaintainPreviousReturnValuesStrategy() {\n+        //given\n+        mock = mock(IMethods.class, RETURNS_MOCKS);\n+        //when\n+        reset(mock);\n+        //then\n+        assertNotNull(mock.iMethodsReturningMethod());\n+    }\n }", "timestamp": 1239808185, "metainfo": ""}