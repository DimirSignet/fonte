{"sha": "e37016eb7235ab789a3c5d0d08cfb63576b665c5", "log": "some renaming, moving classes between packages  --HG-- rename : test/org/mockitousage/examples/Article.java => test/org/mockitousage/examples/use/Article.java rename : test/org/mockitousage/examples/ArticleCalculator.java => test/org/mockitousage/examples/use/ArticleCalculator.java rename : test/org/mockitousage/examples/ArticleDatabase.java => test/org/mockitousage/examples/use/ArticleDatabase.java rename : test/org/mockitousage/examples/ArticleManager.java => test/org/mockitousage/examples/use/ArticleManager.java rename : test/org/mockitousage/examples/MockitoSampleTest.java => test/org/mockitousage/examples/use/MockitoSampleTest.java extra : convert_revision : svn%3Aaa2aecf3-ea3e-0410-9d70-716747e7c967/trunk%40494", "commit": "\n--- a/test/org/mockitousage/MultiThreadedTest.java\n+++ b/test/org/mockitousage/MultiThreadedTest.java\n import org.mockito.internal.verification.VerifyingRecorderTest;\n import org.mockitousage.binding.BridgeMethodPuzzleTest;\n import org.mockitousage.binding.OverloadingPuzzleTest;\n-import org.mockitousage.examples.MockitoSampleTest;\n+import org.mockitousage.examples.use.MockitoSampleTest;\n import org.mockitousage.matchers.ComparableMatchersTest;\n import org.mockitousage.matchers.CustomMatchersTest;\n import org.mockitousage.matchers.InvalidUseOfMatchersTest;\n--- /dev/null\n+++ b/test/org/mockitousage/examples/use/Article.java\n+/*\n+ * Copyright (c) 2007 Mockito contributors\n+ * This program is made available under the terms of the MIT License.\n+ */\n+package org.mockitousage.examples.use;\n+\n+public class Article {\n+\n+    private int numberOfRelatedArticles;\n+\n+    public int getNumberOfRelatedArticles() {\n+        return numberOfRelatedArticles;\n+    }\n+\n+    public void setNumberOfRelatedArticles(int numberOfRelatedArticles) {\n+        this.numberOfRelatedArticles = numberOfRelatedArticles;\n+    }\n+}\n--- /dev/null\n+++ b/test/org/mockitousage/examples/use/ArticleCalculator.java\n+/*\n+ * Copyright (c) 2007 Mockito contributors\n+ * This program is made available under the terms of the MIT License.\n+ */\n+package org.mockitousage.examples.use;\n+\n+public interface ArticleCalculator {\n+    int countArticles(String newspaper);\n+    int countArticlesInPolish(String newspaper);\n+    int countNumberOfRelatedArticles(Article article);\n+    int countAllArticles(String ... publications);\n+}\n--- /dev/null\n+++ b/test/org/mockitousage/examples/use/ArticleDatabase.java\n+/*\n+ * Copyright (c) 2007 Mockito contributors\n+ * This program is made available under the terms of the MIT License.\n+ */\n+package org.mockitousage.examples.use;\n+\n+import java.util.List;\n+\n+public class ArticleDatabase {\n+\n+    public void updateNumberOfArticles(String newspaper, int articles) {\n+    }\n+\n+    public void updateNumberOfPolishArticles(String newspaper, int polishArticles) {\n+    }\n+\n+    public void updateNumberOfEnglishArticles(String newspaper, int i) {\n+    }\n+\n+    public List<Article> getArticlesFor(String string) {\n+        return null;\n+    }\n+\n+    public void save(Article article) {\n+    }\n+}\n--- /dev/null\n+++ b/test/org/mockitousage/examples/use/ArticleManager.java\n+/*\n+ * Copyright (c) 2007 Mockito contributors\n+ * This program is made available under the terms of the MIT License.\n+ */\n+package org.mockitousage.examples.use;\n+\n+import java.util.List;\n+\n+public class ArticleManager {\n+    \n+    private final ArticleCalculator calculator;\n+    private final ArticleDatabase database;\n+\n+    public ArticleManager(ArticleCalculator calculator, ArticleDatabase database) {\n+        this.calculator = calculator;\n+        this.database = database;\n+    }\n+    \n+    public void updateArticleCounters(String newspaper) {\n+        int articles = calculator.countArticles(newspaper);\n+        int polishArticles = calculator.countArticlesInPolish(newspaper);\n+        \n+        database.updateNumberOfArticles(newspaper, articles);\n+        database.updateNumberOfPolishArticles(newspaper, polishArticles);\n+        database.updateNumberOfEnglishArticles(newspaper, articles - polishArticles);\n+    }\n+    \n+    public void updateRelatedArticlesCounters(String newspaper) {\n+        List<Article> articles = database.getArticlesFor(\"Guardian\");\n+        for (Article article : articles) {\n+            int numberOfRelatedArticles = calculator.countNumberOfRelatedArticles(article);\n+            article.setNumberOfRelatedArticles(numberOfRelatedArticles);\n+            database.save(article);\n+        }\n+    }\n+}\n--- /dev/null\n+++ b/test/org/mockitousage/examples/use/MockitoSampleTest.java\n+/*\n+ * Copyright (c) 2007 Mockito contributors\n+ * This program is made available under the terms of the MIT License.\n+ */\n+package org.mockitousage.examples.use;\n+import static org.mockito.Matchers.*;\n+import static org.mockito.Mockito.*;\n+\n+import java.util.Arrays;\n+\n+import org.junit.Before;\n+import org.junit.Test;\n+import org.mockito.InOrder;\n+import org.mockito.TestBase;\n+import org.mockito.MockitoAnnotations.Mock;\n+\n+public class MockitoSampleTest extends TestBase {\n+    \n+    @Mock private ArticleCalculator mockCalculator;\n+    @Mock private ArticleDatabase mockDatabase;\n+    \n+    private ArticleManager articleManager;\n+    \n+    @Before\n+    public void setup() {\n+        articleManager = new ArticleManager(mockCalculator, mockDatabase);\n+    }\n+\n+    @Test\n+    public void managerCountsArticlesAndSavesThemInTheDatabase() {\n+        stub(mockCalculator.countArticles(\"Guardian\")).toReturn(12);\n+        stub(mockCalculator.countArticlesInPolish(anyString())).toReturn(5);\n+\n+//        stub(mockCalculator.countAllArticles(anyString(), \"asdf\")).toReturn(5);\n+        \n+        articleManager.updateArticleCounters(\"Guardian\");\n+        \n+        verify(mockDatabase).updateNumberOfArticles(\"Guardian\", 12);\n+        verify(mockDatabase).updateNumberOfPolishArticles(\"Guardian\", 5);\n+        verify(mockDatabase).updateNumberOfEnglishArticles(\"Guardian\", 7);\n+        \n+        verifyNoMoreInteractions(mockDatabase);\n+    }\n+    \n+    @Test\n+    public void managerCountsArticlesUsingCalculator() {\n+        articleManager.updateArticleCounters(\"Guardian\");\n+\n+        verify(mockCalculator).countArticles(\"Guardian\");\n+        verify(mockCalculator).countArticlesInPolish(\"Guardian\");\n+        \n+        verifyNoMoreInteractions(mockCalculator);\n+    }\n+    \n+    @Test\n+    public void managerSavesArticlesInTheDatabase() {\n+        articleManager.updateArticleCounters(\"Guardian\");\n+\n+        verify(mockDatabase).updateNumberOfArticles(\"Guardian\", 0);\n+        verify(mockDatabase).updateNumberOfPolishArticles(\"Guardian\", 0);\n+        verify(mockDatabase).updateNumberOfEnglishArticles(\"Guardian\", 0);\n+        \n+        verifyNoMoreInteractions(mockDatabase);\n+    }\n+    \n+    @Test\n+    public void managerUpdatesNumberOfRelatedArticles() {\n+        Article articleOne = new Article();\n+        Article articleTwo = new Article();\n+        Article articleThree = new Article();\n+        \n+        stub(mockCalculator.countNumberOfRelatedArticles(articleOne)).toReturn(1);\n+        stub(mockCalculator.countNumberOfRelatedArticles(articleTwo)).toReturn(12);\n+        stub(mockCalculator.countNumberOfRelatedArticles(articleThree)).toReturn(0);\n+        \n+        stub(mockDatabase.getArticlesFor(\"Guardian\")).toReturn(Arrays.asList(articleOne, articleTwo, articleThree)); \n+        \n+        articleManager.updateRelatedArticlesCounters(\"Guardian\");\n+\n+        verify(mockDatabase).save(articleOne);\n+        verify(mockDatabase).save(articleTwo);\n+        verify(mockDatabase).save(articleThree);\n+    }\n+    \n+    @Test\n+    public void shouldPersistRecalculatedArticle() {\n+        Article articleOne = new Article();\n+        Article articleTwo = new Article();\n+        \n+        stub(mockCalculator.countNumberOfRelatedArticles(articleOne)).toReturn(1);\n+        stub(mockCalculator.countNumberOfRelatedArticles(articleTwo)).toReturn(12);\n+        \n+        stub(mockDatabase.getArticlesFor(\"Guardian\")).toReturn(Arrays.asList(articleOne, articleTwo)); \n+        \n+        articleManager.updateRelatedArticlesCounters(\"Guardian\");\n+\n+        InOrder inOrder = inOrder(mockDatabase, mockCalculator);\n+        \n+        inOrder.verify(mockCalculator).countNumberOfRelatedArticles((Article) anyObject());\n+        inOrder.verify(mockDatabase, atLeastOnce()).save((Article) anyObject());\n+    }\n+}", "timestamp": 1206317720, "metainfo": ""}