{"sha": "436dc93626810090924d488d2d4ebdb500580c8c", "log": "issue 233, MockitoConfiguration setting to disable objenesis cache", "commit": "\n--- a/src/org/mockito/configuration/DefaultMockitoConfiguration.java\n+++ b/src/org/mockito/configuration/DefaultMockitoConfiguration.java\n     public boolean cleansStackTrace() {\n         return true;\n     }\n+\n+    /* (non-Javadoc)\n+     * @see org.mockito.configuration.IMockitoConfiguration#enableClassCache()\n+     */\n+    public boolean enableClassCache() {\n+        return true;\n+    }\n+    \n+    \n }\n--- a/src/org/mockito/configuration/IMockitoConfiguration.java\n+++ b/src/org/mockito/configuration/IMockitoConfiguration.java\n      * @return if Mockito should clean stack traces\n      */\n     boolean cleansStackTrace();\n+    \n+    /**\n+     * Allow objenesis to cache classes. If you're in an environment where classes \n+     * are dynamically reloaded, you can disable this to avoid classcast exceptions.\n+     */\n+    boolean enableClassCache();\n }\n--- a/src/org/mockito/internal/configuration/GlobalConfiguration.java\n+++ b/src/org/mockito/internal/configuration/GlobalConfiguration.java\n     public boolean cleansStackTrace() {\n         return globalConfiguration.get().cleansStackTrace();\n     }\n+    \n+    public boolean enableClassCache() {\n+        return globalConfiguration.get().enableClassCache();\n+    }\n \n     public Answer<Object> getDefaultAnswer() {\n         return globalConfiguration.get().getDefaultAnswer();\n--- a/src/org/mockito/internal/creation/jmock/ClassImposterizer.java\n+++ b/src/org/mockito/internal/creation/jmock/ClassImposterizer.java\n import org.mockito.cglib.core.*;\n import org.mockito.cglib.proxy.*;\n import org.mockito.exceptions.base.MockitoException;\n+import org.mockito.internal.configuration.GlobalConfiguration;\n import org.mockito.internal.creation.cglib.MockitoNamingPolicy;\n import org.objenesis.ObjenesisStd;\n \n     //TODO: after 1.8, in order to provide decent exception message when objenesis is not found,\n     //have a constructor in this class that tries to instantiate ObjenesisStd and if it fails then show decent exception that dependency is missing\n     //TODO: after 1.8, for the same reason catch and give better feedback when hamcrest core is not found.\n-    private ObjenesisStd objenesis = new ObjenesisStd();\n+    private ObjenesisStd objenesis = new ObjenesisStd(new GlobalConfiguration().enableClassCache());\n     \n     private static final NamingPolicy NAMING_POLICY_THAT_ALLOWS_IMPOSTERISATION_OF_CLASSES_IN_SIGNED_PACKAGES = new MockitoNamingPolicy() {\n         @Override", "timestamp": 1315813651, "metainfo": ""}