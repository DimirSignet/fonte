{"sha": "57ca83f170c9cda696cc86fe4c85e8642c88801a", "log": "Improve NoInteractionsWanted report to include the name of the mock.", "commit": "\n--- a/src/org/mockito/exceptions/Reporter.java\n+++ b/src/org/mockito/exceptions/Reporter.java\n         throw new NoInteractionsWanted(join(\n                 \"No interactions wanted here:\",\n                 new LocationImpl(),\n-                \"But found this interaction:\",\n+                \"But found this interaction on mock '\" + undesired.getMock() + \"':\",\n                 undesired.getLocation(),\n                 scenario\n         ));\n         throw new VerificationInOrderFailure(join(\n                 \"No interactions wanted here:\",\n                 new LocationImpl(),\n-                \"But found this interaction:\",\n-                undesired.getLocation(),\n-                \"\"\n+                \"But found this interaction on mock '\" + undesired.getMock() + \"':\",\n+                undesired.getLocation()\n         ));\n     }\n \n--- a/test/org/mockito/internal/verification/NoMoreInteractionsTest.java\n+++ b/test/org/mockito/internal/verification/NoMoreInteractionsTest.java\n package org.mockito.internal.verification;\n \n import static java.util.Arrays.*;\n-\n+\n+import org.fest.assertions.Assertions;\n import org.junit.Test;\n+import org.mockito.exceptions.verification.NoInteractionsWanted;\n import org.mockito.exceptions.verification.VerificationInOrderFailure;\n+import org.mockito.internal.creation.MockSettingsImpl;\n import org.mockito.internal.invocation.InvocationBuilder;\n+import org.mockito.internal.invocation.InvocationMatcher;\n+import org.mockito.internal.progress.ThreadSafeMockingProgress;\n+import org.mockito.internal.stubbing.InvocationContainerImpl;\n import org.mockito.internal.verification.api.VerificationDataInOrderImpl;\n import org.mockito.invocation.Invocation;\n import org.mockitoutil.TestBase;\n \n         //when\n         context.markVerified(i2);\n-        \n+\n         //then no exception is thrown\n         n.verifyInOrder(new VerificationDataInOrderImpl(context, asList(i, i2), null));\n     }\n-    \n+\n     @Test\n     public void shouldVerifyInOrderMultipleInvoctionsAndThrow() {\n         //given\n         NoMoreInteractions n = new NoMoreInteractions();\n         Invocation i = new InvocationBuilder().seq(1).toInvocation();\n         Invocation i2 = new InvocationBuilder().seq(2).toInvocation();\n-        \n+\n         try {\n-            //when     \n+            //when\n             n.verifyInOrder(new VerificationDataInOrderImpl(context, asList(i, i2), null));\n             fail();\n         } catch (VerificationInOrderFailure e) {}\n+    }\n+\n+    @Test\n+    public void noMoreInteractionsExceptionMessageShouldDescribeMock() {\n+        //given\n+        NoMoreInteractions n = new NoMoreInteractions();\n+        String mock = \"a mock\";\n+        InvocationMatcher i = new InvocationBuilder().mock(mock).toInvocationMatcher();\n+\n+        InvocationContainerImpl invocations =\n+            new InvocationContainerImpl(new ThreadSafeMockingProgress(), new MockSettingsImpl());\n+        invocations.setInvocationForPotentialStubbing(i);\n+\n+        try {\n+            //when\n+            n.verify(new VerificationDataImpl(invocations, null));\n+            //then\n+            fail();\n+        } catch (NoInteractionsWanted e) {\n+            Assertions.assertThat(e.toString()).contains(mock.toString());\n+        }\n+    }\n+\n+    @Test\n+    public void noMoreInteractionsInOrderExceptionMessageShouldDescribeMock() {\n+        //given\n+        NoMoreInteractions n = new NoMoreInteractions();\n+        String mock = \"a mock\";\n+        Invocation i = new InvocationBuilder().mock(mock).toInvocation();\n+\n+        try {\n+            //when\n+            n.verifyInOrder(new VerificationDataInOrderImpl(context, asList(i), null));\n+            //then\n+            fail();\n+        } catch (VerificationInOrderFailure e) {\n+            Assertions.assertThat(e.toString()).contains(mock.toString());\n+        }\n     }\n }\n--- a/test/org/mockitousage/verification/DescriptiveMessagesWhenVerificationFailsTest.java\n+++ b/test/org/mockitousage/verification/DescriptiveMessagesWhenVerificationFailsTest.java\n \n             String expectedCause =\n                     \"\\n\" +\n-                    \"But found this interaction:\" +\n+                    \"But found this interaction on mock '\" + mock + \"':\" +\n                     \"\\n\" +\n                     \"-> at\";\n             assertContains(expectedCause, e.getMessage());\n \n             String expectedCause =\n                 \"\\n\" +\n-                \"But found this interaction:\" +\n+                \"But found this interaction on mock '\" + mock + \"':\" +\n                 \"\\n\" +\n                 \"-> at\";\n ", "timestamp": 1406706590, "metainfo": ""}