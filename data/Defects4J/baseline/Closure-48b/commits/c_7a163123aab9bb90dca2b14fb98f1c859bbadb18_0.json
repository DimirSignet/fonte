{"sha": "7a163123aab9bb90dca2b14fb98f1c859bbadb18", "log": "Updates and tests for get and set object properties in StripCode  R=nicksantos DELTA=74  (69 added, 0 deleted, 5 changed)   Revision created by MOE tool push_codebase. MOE_MIGRATION=112   ", "commit": "\n--- a/src/com/google/javascript/jscomp/StripCode.java\n+++ b/src/com/google/javascript/jscomp/StripCode.java\n     void eliminateKeysWithStripNamesFromObjLit(NodeTraversal t, Node n) {\n       // OBJLIT\n       //   key1\n-      //   value1\n+      //     value1\n+      //   key2\n       //   ...\n       Node key = n.getFirstChild();\n       while (key != null) {\n-        if (key.getType() == Token.STRING &&\n-            isStripName(key.getString())) {\n+        if (key.getType() != Token.NUMBER\n+            && isStripName(key.getString())) {\n           Node value = key.getFirstChild();\n           Node next = key.getNext();\n           n.removeChild(key);\n--- a/test/com/google/javascript/jscomp/StripCodeTest.java\n+++ b/test/com/google/javascript/jscomp/StripCodeTest.java\n          \"a.b.c=function(){}\");\n   }\n \n-  public void testLoggerDefinedInPrototype() {\n+  public void testLoggerDefinedInPrototype1() {\n     test(\"a.b.c = function() {};\" +\n          \"a.b.c.prototype.logger = goog.debug.Logger.getLogger('a.b.c');\",\n          \"a.b.c=function(){}\");\n   }\n \n+  public void testLoggerDefinedInPrototype2() {\n+    test(\"a.b.c = function() {};\" +\n+         \"a.b.c.prototype = {logger: goog.debug.Logger.getLogger('a.b.c')}\",\n+         \"a.b.c = function() {};\" +\n+         \"a.b.c.prototype = {}\");\n+  }\n+\n+  public void testLoggerDefinedInPrototype3() {\n+    test(\"a.b.c = function() {};\" +\n+         \"a.b.c.prototype = { \" +\n+         \"  get logger() {return goog.debug.Logger.getLogger('a.b.c')}\" +\n+         \"}\",\n+         \"a.b.c = function() {};\" +\n+         \"a.b.c.prototype = {}\");\n+  }\n+\n+  public void testLoggerDefinedInPrototype4() {\n+    test(\"a.b.c = function() {};\" +\n+         \"a.b.c.prototype = { \" +\n+         \"  set logger(a) {this.x = goog.debug.Logger.getLogger('a.b.c')}\" +\n+         \"}\",\n+         \"a.b.c = function() {};\" +\n+         \"a.b.c.prototype = {}\");\n+  }\n+\n+  public void testLoggerDefinedInPrototype5() {\n+    test(\"a.b.c = function() {};\" +\n+         \"a.b.c.prototype = { \" +\n+         \"  get f() {return this.x;},\" +\n+         \"  set f(a) {this.x = goog.debug.Logger.getLogger('a.b.c')}\" +\n+         \"}\",\n+         \"a.b.c = function() {};\" +\n+         \"a.b.c.prototype = { \" +\n+         \"  get f() {return this.x;},\" +\n+         \"  set f(a) {this.x = null}\" +\n+         \"}\");\n+  }\n+\n   public void testLoggerDefinedStatically() {\n     test(\"a.b.c = function() {};\" +\n          \"a.b.c.logger = goog.debug.Logger.getLogger('a.b.c');\",\n          \"a.b.c=function(){}\");\n   }\n \n-  public void testLoggerDefinedInObjectLiteral() {\n+  public void testLoggerDefinedInObjectLiteral1() {\n     test(\"a.b.c = {\" +\n          \"  x: 0,\" +\n          \"  logger: goog.debug.Logger.getLogger('a.b.c')\" +\n          \"};\",\n          \"a.b.c={x:0}\");\n+  }\n+\n+  public void testLoggerDefinedInObjectLiteral2() {\n+    test(\"a.b.c = {\" +\n+         \"  x: 0,\" +\n+         \"  get logger() {return goog.debug.Logger.getLogger('a.b.c')}\" +\n+         \"};\",\n+         \"a.b.c={x:0}\");\n+  }\n+\n+  public void testLoggerDefinedInObjectLiteral3() {\n+    test(\"a.b.c = {\" +\n+         \"  x: null,\" +\n+         \"  get logger() {return this.x},\" +\n+         \"  set logger(a) {this.x  = goog.debug.Logger.getLogger(a)}\" +\n+         \"};\",\n+         \"a.b.c={x:null}\");\n+  }\n+\n+  public void testLoggerDefinedInObjectLiteral4() {\n+    test(\"a.b.c = {\" +\n+         \"  x: null,\" +\n+         \"  get y() {return this.x},\" +\n+         \"  set y(a) {this.x  = goog.debug.Logger.getLogger(a)}\" +\n+         \"};\",\n+         \"a.b.c = {\" +\n+         \"  x: null,\" +\n+         \"  get y() {return this.x},\" +\n+         \"  set y(a) {this.x  = null}\" +\n+         \"};\");\n   }\n \n   public void testLoggerDefinedInPrototypeAndUsedInConstructor() {", "timestamp": 1292006469, "metainfo": ""}