{"sha": "af7a99319796e8f7f804796a3a0ace6e71c993d1", "log": "Improve escape sequence handling. Fixes issue 711  R=johnlenz DELTA=27  (27 added, 0 deleted, 0 changed)   Revision created by MOE tool push_codebase. MOE_MIGRATION=4622   ", "commit": "\n--- a/src/com/google/javascript/jscomp/CodeGenerator.java\n+++ b/src/com/google/javascript/jscomp/CodeGenerator.java\n             sb.append(\"\\\\x0B\");\n           }\n           break;\n+        // From the SingleEscapeCharacter grammar production.\n+        case '\\b': sb.append(\"\\\\b\"); break;\n+        case '\\f': sb.append(\"\\\\f\"); break;\n         case '\\n': sb.append(\"\\\\n\"); break;\n         case '\\r': sb.append(\"\\\\r\"); break;\n         case '\\t': sb.append(\"\\\\t\"); break;\n--- a/test/com/google/javascript/jscomp/CodePrinterTest.java\n+++ b/test/com/google/javascript/jscomp/CodePrinterTest.java\n     parse(expected); // validate the expected string is valid js\n     assertEquals(expected,\n         parsePrint(js, false, CodePrinter.DEFAULT_LINE_LENGTH_THRESHOLD));\n+  }\n+\n+  private void assertPrintSame(String js) {\n+    assertPrint(js, js);\n   }\n \n   // Make sure that the code generator doesn't associate an\n     // it from positive zero (there are some subtle differences in behavior).\n     assertPrint(\"x- -0\", \"x- -0.0\");\n   }\n+\n+  public void testStringEscapeSequences() {\n+    // From the SingleEscapeCharacter grammar production.\n+    assertPrintSame(\"var x=\\\"\\\\b\\\"\");\n+    assertPrintSame(\"var x=\\\"\\\\f\\\"\");\n+    assertPrintSame(\"var x=\\\"\\\\n\\\"\");\n+    assertPrintSame(\"var x=\\\"\\\\r\\\"\");\n+    assertPrintSame(\"var x=\\\"\\\\t\\\"\");\n+    assertPrintSame(\"var x=\\\"\\\\v\\\"\");\n+    assertPrint(\"var x=\\\"\\\\\\\"\\\"\", \"var x='\\\"'\");\n+    assertPrint(\"var x=\\\"\\\\\\'\\\"\", \"var x=\\\"'\\\"\");\n+\n+    // Now with regular expressions.\n+    assertPrintSame(\"var x=/\\\\b/\");\n+    assertPrintSame(\"var x=/\\\\f/\");\n+    assertPrintSame(\"var x=/\\\\n/\");\n+    assertPrintSame(\"var x=/\\\\r/\");\n+    assertPrintSame(\"var x=/\\\\t/\");\n+    assertPrintSame(\"var x=/\\\\v/\");\n+  }\n }", "timestamp": 1335474913, "metainfo": ""}