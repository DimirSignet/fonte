{"sha": "c9f5de5e7b5c8fff6c56b5bad2c0039aa3b4e72d", "log": "Properly escape line feed and paragraph feed. Fixes issue 718 Contributed by DunbarB2  R=johnlenz DELTA=16  (16 added, 0 deleted, 0 changed)   Revision created by MOE tool push_codebase. MOE_MIGRATION=4668   ", "commit": "\n--- a/src/com/google/javascript/jscomp/CodeGenerator.java\n+++ b/src/com/google/javascript/jscomp/CodeGenerator.java\n         case '\\\\': sb.append(backslashEscape); break;\n         case '\\\"': sb.append(doublequoteEscape); break;\n         case '\\'': sb.append(singlequoteEscape); break;\n+\n+        // From LineTerminators (ES5 Section 7.3, Table 3)\n+        case '\\u2028': sb.append(\"\\\\u2028\"); break;\n+        case '\\u2029': sb.append(\"\\\\u2029\"); break;\n+\n         case '>':                       // Break --> into --\\> or ]]> into ]]\\>\n           if (i >= 2 &&\n               ((s.charAt(i - 1) == '-' && s.charAt(i - 2) == '-') ||\n--- a/test/com/google/javascript/jscomp/CodePrinterTest.java\n+++ b/test/com/google/javascript/jscomp/CodePrinterTest.java\n     assertPrint(\"var x=\\\"\\\\\\\"\\\"\", \"var x='\\\"'\");\n     assertPrint(\"var x=\\\"\\\\\\'\\\"\", \"var x=\\\"'\\\"\");\n \n+    // From the LineTerminator grammar\n+    assertPrint(\"var x=\\\"\\\\u000A\\\"\", \"var x=\\\"\\\\n\\\"\");\n+    assertPrint(\"var x=\\\"\\\\u000D\\\"\", \"var x=\\\"\\\\r\\\"\");\n+    assertPrintSame(\"var x=\\\"\\\\u2028\\\"\");\n+    assertPrintSame(\"var x=\\\"\\\\u2029\\\"\");\n+\n     // Now with regular expressions.\n     assertPrintSame(\"var x=/\\\\b/\");\n     assertPrintSame(\"var x=/\\\\f/\");\n     assertPrintSame(\"var x=/\\\\r/\");\n     assertPrintSame(\"var x=/\\\\t/\");\n     assertPrintSame(\"var x=/\\\\v/\");\n+    assertPrintSame(\"var x=/\\\\u000A/\");\n+    assertPrintSame(\"var x=/\\\\u000D/\");\n+    assertPrintSame(\"var x=/\\\\u2028/\");\n+    assertPrintSame(\"var x=/\\\\u2029/\");\n   }\n }", "timestamp": 1335999659, "metainfo": ""}