{"sha": "11f0b4090937b2aa998734aa2bf032ee8c428e84", "log": "Always return empty array instead of null for empty buffer  Fixes #182", "commit": "\n--- a/src/main/java/com/fasterxml/jackson/core/util/TextBuffer.java\n+++ b/src/main/java/com/fasterxml/jackson/core/util/TextBuffer.java\n             return (_resultArray = _resultString.toCharArray());\n         }\n         // Nope; but does it fit in just one segment?\n-        if (!_hasSegments)  return _currentSegment;\n+        if (!_hasSegments && _currentSegment != null)  return _currentSegment;\n         // Nope, need to have/create a non-segmented array and return it\n         return contentsAsArray();\n     }\n--- a/src/test/java/com/fasterxml/jackson/core/util/TestTextBuffer.java\n+++ b/src/test/java/com/fasterxml/jackson/core/util/TestTextBuffer.java\n package com.fasterxml.jackson.core.util;\n-\n-import com.fasterxml.jackson.core.util.BufferRecycler;\n-import com.fasterxml.jackson.core.util.TextBuffer;\n \n public class TestTextBuffer\n     extends com.fasterxml.jackson.core.BaseTest\n               }\n           }\n       }\n+\n+    // [Core#182]\n+    public void testEmpty() {\n+        TextBuffer tb = new TextBuffer(new BufferRecycler());\n+        tb.resetWithEmpty();\n+\n+        assertTrue(tb.getTextBuffer().length == 0);\n+        tb.contentsAsString();\n+        assertTrue(tb.getTextBuffer().length == 0);\n+    }\n }", "timestamp": 1424311146, "metainfo": ""}