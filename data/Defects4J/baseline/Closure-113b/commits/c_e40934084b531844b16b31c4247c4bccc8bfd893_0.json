{"sha": "e40934084b531844b16b31c4247c4bccc8bfd893", "log": "Automated g4 rollback.  *** Reason for rollback ***  Broke build.  *** Original change description ***  Insert the \"something['$inject'] = [...];\" statement after any goog.inherits calls, to stop @ngInject from interfering with inheritance.  Based on GenerateExports. ------------- Created by MOE: http://code.google.com/p/moe-java MOE_MIGRATED_REVID=43912362", "commit": "\n--- a/src/com/google/javascript/jscomp/AngularPass.java\n+++ b/src/com/google/javascript/jscomp/AngularPass.java\n               dependenciesArray\n           )\n       );\n-      // adds `something.$inject = [...]` node after the annotated node or the following\n-      // goog.inherits call.\n-      Node insertionPoint = entry.getTarget();\n-      Node next = insertionPoint.getNext();\n-      while (next != null &&\n-             NodeUtil.isExprCall(next) &&\n-             convention.getClassesDefinedByCall(\n-                 next.getFirstChild()) != null) {\n-          insertionPoint = next;\n-          next = insertionPoint.getNext();\n-      }\n-\n-      insertionPoint.getParent().addChildAfter(statement, insertionPoint);\n+      // adds `something.$inject = [...]` node after the annotated node.\n+      Node target = entry.getTarget();\n+      target.getParent().addChildAfter(statement, target);\n       codeChanged = true;\n     }\n     if (codeChanged) {\n--- a/test/com/google/javascript/jscomp/AngularPassTest.java\n+++ b/test/com/google/javascript/jscomp/AngularPassTest.java\n     );\n   }\n \n-  public void testNgInjectAddsInjectAfterGoogInherits() throws Exception {\n-    test(\n-        \"/** @ngInject \\n @constructor */\" +\n-        \"function fn(a, b) {}\" +\n-        \"goog.inherits(fn, parent);\",\n-\n-        \"function fn(a, b) {}\\n\" +\n-        \"goog.inherits(fn, parent);\" +\n-        \"fn['$inject']=['a', 'b']\"\n-    );\n-\n-    test(\n-        \"/** @ngInject \\n @constructor */\" +\n-        \"function fn(a, b) {}\" +\n-        \"goog.inherits(fn, parent);\" +\n-        \"var foo = 42;\",\n-\n-        \"function fn(a, b) {}\\n\" +\n-        \"goog.inherits(fn, parent);\" +\n-        \"fn['$inject']=['a', 'b'] + \" +\n-        \"var foo = 42;\";\n-    );\n-  }\n-\n   public void testNgInjectAddsInjectToProps() throws Exception {\n     test(\n         \"var ns = {};\\n\" +", "timestamp": 1363292074, "metainfo": ""}