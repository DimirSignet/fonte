{"sha": "7eea7641b125acd2bbbcaf8f5b6149a183d05154", "log": "Make sure the JSDoc is preserved when collapsing declarations.  R=nicksantos DELTA=19  (19 added, 0 deleted, 0 changed)   Revision created by MOE tool push_codebase. MOE_MIGRATION=4855   ", "commit": "\n--- a/src/com/google/javascript/jscomp/CollapseProperties.java\n+++ b/src/com/google/javascript/jscomp/CollapseProperties.java\n         nameNode.putBooleanProp(Node.IS_CONSTANT_NAME, true);\n       }\n \n+      if (info != null) {\n+        varNode.setJSDocInfo(info);\n+      }\n       varNode.addChildToBack(nameNode);\n       nameNode.addChildToFront(rvalue);\n       varParent.replaceChild(gramps, varNode);\n--- a/test/com/google/javascript/jscomp/CollapsePropertiesTest.java\n+++ b/test/com/google/javascript/jscomp/CollapsePropertiesTest.java\n package com.google.javascript.jscomp;\n \n import static com.google.javascript.jscomp.CollapseProperties.UNSAFE_THIS;\n+\n+import com.google.javascript.rhino.Node;\n \n /**\n  * Tests for {@link CollapseProperties}.\n         null,\n         CollapseProperties.NAMESPACE_REDEFINED_WARNING);\n   }\n+\n+  public void testPreserveConstructorDoc() {\n+    test(\"var foo = {};\" +\n+         \"/** @constructor */\\n\" +\n+         \"foo.bar = function() {}\",\n+         \"var foo$bar = function() {}\");\n+\n+    Node root = getLastCompiler().getRoot();\n+\n+    Node fooBarNode = findQualifiedNameNode(\"foo$bar\", root);\n+    Node varNode = fooBarNode.getParent();\n+    assertTrue(varNode.isVar());\n+    assertTrue(varNode.getJSDocInfo().isConstructor());\n+  }\n }", "timestamp": 1337880808, "metainfo": ""}