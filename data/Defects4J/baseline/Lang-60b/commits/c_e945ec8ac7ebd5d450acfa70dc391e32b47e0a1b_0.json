{"sha": "e945ec8ac7ebd5d450acfa70dc391e32b47e0a1b", "log": "Added testSelfInstanceVarReflectionObjectCycle to replicate an example in http://issues.apache.org/bugzilla/show_bug.cgi?id=19331. This is a bit redundant with other tests, but insures the given example is handled.   ", "commit": "\n--- a/src/test/org/apache/commons/lang/builder/ToStringBuilderTest.java\n+++ b/src/test/org/apache/commons/lang/builder/ToStringBuilderTest.java\n  * @author <a href=\"mailto:scolebourne@joda.org\">Stephen Colebourne</a>\n  * @author <a href=\"mailto:ggregory@seagullsw.com\">Gary Gregory</a>\n  * @author <a href=\"mailto:alex@apache.org\">Alex Chaffee</a>\n- * @version $Id: ToStringBuilderTest.java,v 1.15 2004/07/01 17:58:09 ggregory Exp $\n+ * @version $Id: ToStringBuilderTest.java,v 1.16 2004/07/26 21:39:21 ggregory Exp $\n  */\n public class ToStringBuilderTest extends TestCase {\n \n         }\n     }\n \n+    private static class SelfInstanceVarReflectionTestFixture {\n+        private SelfInstanceVarReflectionTestFixture typeIsSelf;\n+\n+        public SelfInstanceVarReflectionTestFixture() {\n+            this.typeIsSelf = this;\n+        }\n+\n+        public String toString() {\n+            return ToStringBuilder.reflectionToString(this);\n+        }\n+      }\n+    \n     /**\n      * Test an Object pointing to itself, the simplest test.\n      * \n         simple.o = simple;\n         assertTrue(ReflectionToStringBuilder.getRegistry().isEmpty());\n         assertEquals(this.toBaseString(simple) + \"[o=\" + this.toBaseString(simple) + \"]\", simple.toString());\n+        this.validateEmptyReflectionRegistry();\n+    }\n+\n+    /**\n+     * Test a class that defines an ivar pointing to itself.\n+     * \n+     * @throws Exception\n+     */\n+    public void testSelfInstanceVarReflectionObjectCycle() throws Exception {\n+        SelfInstanceVarReflectionTestFixture test = new SelfInstanceVarReflectionTestFixture();\n+        assertTrue(ReflectionToStringBuilder.getRegistry().isEmpty());\n+        assertEquals(this.toBaseString(test) + \"[typeIsSelf=\" + this.toBaseString(test) + \"]\", test.toString());\n         this.validateEmptyReflectionRegistry();\n     }\n ", "timestamp": 1090877961, "metainfo": ""}