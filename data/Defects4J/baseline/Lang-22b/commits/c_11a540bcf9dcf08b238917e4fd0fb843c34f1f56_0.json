{"sha": "11a540bcf9dcf08b238917e4fd0fb843c34f1f56", "log": "Patch for RandomString bug in which counts of 0 or negative counts would cause array exceptions.  Submitted by:\tville.skytta@iki.fi (Ville Skytt\ufffd)   ", "commit": "\n--- a/src/java/org/apache/commons/lang/RandomStringUtils.java\n+++ b/src/java/org/apache/commons/lang/RandomStringUtils.java\n  * @author <a href=\"mailto:steven@caswell.name\">Steven Caswell</a>\n  * @author Stephen Colebourne\n  * @since 1.0\n- * @version $Id: RandomStringUtils.java,v 1.9 2003/03/23 18:00:59 scolebourne Exp $\n+ * @version $Id: RandomStringUtils.java,v 1.10 2003/04/09 14:13:03 bayard Exp $\n  */\n public class RandomStringUtils {\n \n      * @return the random string\n      * @throws ArrayIndexOutOfBoundsException if there are not\n      *  <code>(end - start) + 1</code> characters in the set array.\n+     * @throws IllegalArgumentException if <code>count</code> &lt; 0.\n      */\n     public static String random(int count, int start, int end, boolean letters, boolean numbers, char[] set, Random random) {\n+        if( count == 0 ) {\n+            return \"\";\n+        } else if( count < 0 ) {\n+            throw new IllegalArgumentException(\"Requested random string length \" + count + \" is less than 0.\");\n+        }\n         if( (start == 0) && (end == 0) ) {\n             end = (int)'z';\n             start = (int)' ';\n--- a/src/test/org/apache/commons/lang/RandomStringUtilsTest.java\n+++ b/src/test/org/apache/commons/lang/RandomStringUtilsTest.java\n  *\n  * @author <a href=\"mailto:steven@caswell.name\">Steven Caswell</a>\n  * @author <a href=\"mailto:ridesmet@users.sourceforge.net\">Ringo De Smet</a>\n- * @version $Id: RandomStringUtilsTest.java,v 1.4 2003/03/23 21:50:58 scolebourne Exp $\n+ * @version $Id: RandomStringUtilsTest.java,v 1.5 2003/04/09 14:13:03 bayard Exp $\n  */\n public class RandomStringUtilsTest extends junit.framework.TestCase {\n     /**\n         r1 = RandomStringUtils.random(50,0,0,true,true,null,new Random(seed));\n         r2 = RandomStringUtils.random(50,0,0,true,true,null,new Random(seed));\n         assertEquals(\"r1.equals(r2)\", r1, r2);\n+\n+        r1 = RandomStringUtils.random(0);\n+        assertEquals(\"random(0).equals(\\\"\\\")\", \"\", r1);\n+\n+        Exception e = null;\n+        try {\n+            r1 = RandomStringUtils.random(-1);\n+        } catch (Exception e2) {\n+            e = e2;\n+        }\n+        assertNotNull(\"random(<0) throws exception\", e);\n     }\n \n     public static void main(String args[]) {", "timestamp": 1049897583, "metainfo": ""}